(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{2124:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/devtools",function(){return a(2632)}])},2632:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return iT}});var n=a(2676),i=a(5271),s=a(4517),o=a(8426),l=a(4029),r=a(5873),c=a(2544),d=a(8142);function u(e){let t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),s=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),l=t.getSeconds().toString().padStart(2,"0"),r=t.getMilliseconds().toString().padStart(3,"0");return"".concat(a,"-").concat(n,"-").concat(i," ").concat(s,":").concat(o,":").concat(l,".").concat(r)}function m(e){return navigator.clipboard?navigator.clipboard.writeText(e):Promise.resolve()}function g(e,t){return"string"==typeof e&&t.indexOf(e)>=0}function h(e,t){if(e)return t.filter(e=>""!==e);let a="https:"===window.location.protocol?"wss://":"ws://",n=window.location.port?":".concat(window.location.port):"";return"".concat(a+window.location.hostname+n,"/signaling")}let p=/^(\d+)x(\d+)$/;function v(e){if(p.test(e)){let t=e.match(p);if(t)return{width:Number.parseInt(t[1],10),height:Number.parseInt(t[2],10)}}return{width:0,height:0}}function x(e){switch(e){case"4:3":return 4/3;case"16:9":return 16/9;case"21:9":return 20/9;default:return Number.NaN}}function j(e){let{audio:t,autoGainControl:a,noiseSuppression:n,echoCancellation:i,echoCancellationType:s}=e;if(!t)return!1;if(!a&&!n&&!i&&!s)return!0;let o={},l=C(a);void 0!==l&&(o.autoGainControl=l);let r=C(n);void 0!==r&&(o.noiseSuppression=r);let c=C(i);return void 0!==c&&(o.echoCancellation=c),s&&(o.echoCancellationType=s),o}function f(e){let{aspectRatio:t,frameRate:a,resizeMode:n,resolution:i}=e;if(!a&&!i&&!t&&!n)return!0;let s={};if(a){let e=Number.parseInt(a,10);Number.isNaN(e)||(s.frameRate=e)}if(i){let{width:e,height:t}=v(i);0<e&&0<t&&(s.width=e,s.height=t)}return t&&(s.aspectRatio=x(t)),n&&(s.resizeMode=n),s}function C(e){return"true"===e||"false"!==e&&void 0}function b(e,t){if(e){try{return JSON.parse(t)}catch(e){}return t}}async function S(){if(void 0===navigator.mediaDevices)return[];try{return await navigator.mediaDevices.enumerateDevices()}catch(e){}return[]}function y(e){return"preparing"===e||"connected"===e||"connecting"===e}function N(e){return{id:e.id,label:e.label,kind:e.kind,enabled:e.enabled,muted:e.muted,readyState:e.readyState,contentHint:e.contentHint,getConstraints:e.getConstraints(),getCapabilities:e.getCapabilities?e.getCapabilities():null,getSettings:e.getSettings()}}function k(e){let t={audio:e.audio,video:e.video};if(!("recvonly"===e.role&&("true"===e.multistream||""===e.multistream))){e.audioCodecType&&(t.audioCodecType=e.audioCodecType);let a=Number.parseInt(e.audioBitRate,10);a&&(t.audioBitRate=a),e.videoCodecType&&(t.videoCodecType=e.videoCodecType);let n=Number.parseInt(e.videoBitRate,10);n&&(t.videoBitRate=n),e.enabledVideoVP9Params&&(t.videoVP9Params=b(!0,e.videoVP9Params)),e.enabledVideoH264Params&&(t.videoH264Params=b(!0,e.videoH264Params)),e.enabledVideoH265Params&&(t.videoH265Params=b(!0,e.videoH265Params)),e.enabledVideoAV1Params&&(t.videoAV1Params=b(!0,e.videoAV1Params)),e.enabledAudioStreamingLanguageCode&&(t.audioStreamingLanguageCode=e.audioStreamingLanguageCode)}let a=C(e.multistream);void 0!==a&&(t.multistream=a);let n=C(e.spotlight);void 0!==n&&(t.spotlight=n,!0===n&&(e.spotlightNumber&&(t.spotlightNumber=Number.parseInt(e.spotlightNumber)),e.spotlightFocusRid&&(t.spotlightFocusRid=e.spotlightFocusRid),e.spotlightUnfocusRid&&(t.spotlightUnfocusRid=e.spotlightUnfocusRid)));let i=C(e.simulcast);if(void 0!==i&&(t.simulcast=i,!0===i&&e.simulcastRid&&(t.simulcastRid=e.simulcastRid)),e.enabledSignalingNotifyMetadata&&(t.signalingNotifyMetadata=b(!0,e.signalingNotifyMetadata)),e.enabledForwardingFilter&&(t.forwardingFilter=b(!0,e.forwardingFilter)),e.enabledBundleId&&(t.bundleId=e.bundleId),e.enabledClientId&&(t.clientId=e.clientId),e.enabledDataChannel){let a=C(e.dataChannelSignaling);void 0!==a&&(t.dataChannelSignaling=a);let n=C(e.ignoreDisconnectWebSocket);void 0!==n&&(t.ignoreDisconnectWebSocket=n)}if(""!==e.dataChannels){let a=[];try{a=JSON.parse(e.dataChannels)}catch(e){console.warn("Illegal format DataChannels")}Array.isArray(a)&&(t.dataChannels=a)}return t}var T=a(3376);let I=()=>async(e,t)=>{e(T.slice.actions.resetState());let a=function(){let e;let t=e=>{if("string"==typeof e)return e},a=e=>{if("string"==typeof e)return C(e)},n=(e,t)=>{if(g(e,t))return e},i=c.Z.parse(location.search);if("string"==typeof i.signalingUrlCandidates)try{e=JSON.parse(i.signalingUrlCandidates)}catch(e){}let s={apiUrl:t(i.apiUrl),audio:a(i.audio),audioBitRate:n(i.audioBitRate,d.xR),audioCodecType:n(i.audioCodecType,d.o1),audioStreamingLanguageCode:t(i.audioStreamingLanguageCode),autoGainControl:n(i.autoGainControl,d.iN),bundleId:t(i.bundleId),channelId:t(i.channelId),clientId:t(i.clientId),googCpuOveruseDetection:a(i.googCpuOveruseDetection),debug:a(i.debug),debugType:n(i.debugType,d.aF),displayResolution:t(i.displayResolution),echoCancellation:n(i.echoCancellation,d.PS),echoCancellationType:n(i.echoCancellationType,d.cJ),noiseSuppression:n(i.noiseSuppression,d.ad),facingMode:n(i.facingMode,d.pT),fakeVolume:t(i.fakeVolume),frameRate:t(i.frameRate),mediaStats:a(i.mediaStats),mediaType:n(i.mediaType,d.w_),metadata:t(i.metadata),showStats:a(i.showStats),signalingNotifyMetadata:t(i.signalingNotifyMetadata),signalingUrlCandidates:Array.isArray(e)?e:void 0,forwardingFilter:t(i.forwardingFilter),simulcast:n(i.simulcast,d.VE),simulcastRid:n(i.simulcastRid,d.WJ),spotlight:n(i.spotlight,d.VJ),spotlightNumber:n(i.spotlightNumber,d.Xr),spotlightFocusRid:n(i.spotlightFocusRid,d.I7),spotlightUnfocusRid:n(i.spotlightUnfocusRid,d.I7),resolution:t(i.resolution),video:a(i.video),videoBitRate:n(i.videoBitRate,d.Q5),videoCodecType:n(i.videoCodecType,d.Sh),videoVP9Params:t(i.videoVP9Params),videoH264Params:t(i.videoH264Params),videoH265Params:t(i.videoH265Params),videoAV1Params:t(i.videoAV1Params),audioInput:t(i.audioInput),videoInput:t(i.videoInput),audioOutput:t(i.audioOutput),mute:a(i.mute),dataChannelSignaling:n(i.dataChannelSignaling,d.l9),ignoreDisconnectWebSocket:n(i.ignoreDisconnectWebSocket,d.kt),micDevice:a(i.micDevice),cameraDevice:a(i.cameraDevice),audioTrack:a(i.audioTrack),videoTrack:a(i.videoTrack),dataChannels:t(i.dataChannels),reconnect:a(i.reconnect),audioContentHint:n(i.audioContentHint,d.nT),videoContentHint:n(i.videoContentHint,d.QO),aspectRatio:n(i.aspectRatio,d.Ii),resizeMode:n(i.resizeMode,d.L4),blurRadius:n(i.blurRadius,d.G_),lightAdjustment:n(i.lightAdjustment,d.Xv),mediaProcessorsNoiseSuppression:a(i.mediaProcessorsNoiseSuppression),multistream:n(i.multistream,d.u9),role:n(i.role,d.K$)};return Object.keys(s).map(e=>{void 0===s[e]&&delete s[e]}),s}();void 0!==a.audio&&e(T.slice.actions.setAudio(a.audio)),void 0!==a.audioBitRate&&e(T.slice.actions.setAudioBitRate(a.audioBitRate)),void 0!==a.audioCodecType&&e(T.slice.actions.setAudioCodecType(a.audioCodecType));let n=await S(),i=n.find(e=>"audioinput"===e.kind&&e.deviceId===a.audioInput);void 0!==i&&e(T.slice.actions.setAudioInput(i.deviceId));let s=n.find(e=>"audiooutput"===e.kind&&e.deviceId===a.audioOutput);void 0!==s&&e(T.slice.actions.setAudioOutput(s.deviceId));let o=n.find(e=>"videoinput"===e.kind&&e.deviceId===a.videoInput);void 0!==o&&e(T.slice.actions.setVideoInput(o.deviceId)),void 0!==a.autoGainControl&&e(T.slice.actions.setAutoGainControl(a.autoGainControl)),void 0!==a.channelId&&e(T.slice.actions.setChannelId(a.channelId)),void 0!==a.displayResolution&&e(T.slice.actions.setDisplayResolution(a.displayResolution)),void 0!==a.echoCancellation&&e(T.slice.actions.setEchoCancellation(a.echoCancellation)),void 0!==a.echoCancellationType&&e(T.slice.actions.setEchoCancellationType(a.echoCancellationType)),void 0!==a.mediaStats&&e(T.slice.actions.setMediaStats(a.mediaStats)),void 0!==a.mediaType&&e(T.slice.actions.setMediaType(a.mediaType)),void 0!==a.facingMode&&e(T.slice.actions.setFacingMode(a.facingMode)),void 0!==a.fakeVolume&&e(T.slice.actions.setFakeVolume(a.fakeVolume)),void 0!==a.frameRate&&e(T.slice.actions.setFrameRate(a.frameRate)),void 0!==a.multistream&&e(T.slice.actions.setMultistream(a.multistream)),void 0!==a.noiseSuppression&&e(T.slice.actions.setNoiseSuppression(a.noiseSuppression)),void 0!==a.resolution&&e(T.slice.actions.setResolution(a.resolution)),void 0!==a.showStats&&e(T.slice.actions.setShowStats(a.showStats)),void 0!==a.simulcast&&e(T.slice.actions.setSimulcast(a.simulcast)),void 0!==a.simulcastRid&&e(T.slice.actions.setSimulcastRid(a.simulcastRid)),void 0!==a.spotlight&&e(T.slice.actions.setSpotlight(a.spotlight)),void 0!==a.spotlightNumber&&e(T.slice.actions.setSpotlightNumber(a.spotlightNumber)),void 0!==a.spotlightFocusRid&&e(T.slice.actions.setSpotlightFocusRid(a.spotlightFocusRid)),void 0!==a.spotlightUnfocusRid&&e(T.slice.actions.setSpotlightUnfocusRid(a.spotlightUnfocusRid)),void 0!==a.video&&e(T.slice.actions.setVideo(a.video)),void 0!==a.videoBitRate&&e(T.slice.actions.setVideoBitRate(a.videoBitRate)),void 0!==a.videoCodecType&&e(T.slice.actions.setVideoCodecType(a.videoCodecType)),void 0!==a.videoVP9Params&&e(T.slice.actions.setVideoVP9Params(a.videoVP9Params)),void 0!==a.videoH264Params&&e(T.slice.actions.setVideoH264Params(a.videoH264Params)),void 0!==a.videoH265Params&&e(T.slice.actions.setVideoH265Params(a.videoH265Params)),void 0!==a.videoAV1Params&&e(T.slice.actions.setVideoAV1Params(a.videoAV1Params)),void 0!==a.debug&&e(T.slice.actions.setDebug(a.debug)),void 0!==a.debugType&&e(T.slice.actions.setDebugType(a.debugType)),void 0!==a.mute&&e(T.slice.actions.setMute(a.mute)),void 0!==a.dataChannelSignaling&&e(T.slice.actions.setDataChannelSignaling(a.dataChannelSignaling)),void 0!==a.ignoreDisconnectWebSocket&&e(T.slice.actions.setIgnoreDisconnectWebSocket(a.ignoreDisconnectWebSocket)),void 0!==a.micDevice&&e(T.slice.actions.setMicDevice(a.micDevice)),void 0!==a.cameraDevice&&e(T.slice.actions.setCameraDevice(a.cameraDevice)),void 0!==a.audioTrack&&e(T.slice.actions.setAudioTrack(a.audioTrack)),void 0!==a.videoTrack&&e(T.slice.actions.setVideoTrack(a.videoTrack)),void 0!==a.googCpuOveruseDetection&&null!==a.googCpuOveruseDetection&&e(T.slice.actions.setGoogCpuOveruseDetection(a.googCpuOveruseDetection)),void 0!==a.bundleId&&e(T.slice.actions.setBundleId(a.bundleId)),void 0!==a.clientId&&e(T.slice.actions.setClientId(a.clientId)),void 0!==a.metadata&&e(T.slice.actions.setMetadata(a.metadata)),void 0!==a.signalingNotifyMetadata&&e(T.slice.actions.setSignalingNotifyMetadata(a.signalingNotifyMetadata)),void 0!==a.signalingUrlCandidates&&e(T.slice.actions.setSignalingUrlCandidates(a.signalingUrlCandidates)),void 0!==a.forwardingFilter&&e(T.slice.actions.setForwardingFilter(a.forwardingFilter)),void 0!==a.dataChannels&&e(T.slice.actions.setDataChannels(a.dataChannels)),void 0!==a.audioContentHint&&e(T.slice.actions.setAudioContentHint(a.audioContentHint)),void 0!==a.videoContentHint&&e(T.slice.actions.setVideoContentHint(a.videoContentHint)),void 0!==a.reconnect&&e(T.slice.actions.setReconnect(a.reconnect)),void 0!==a.aspectRatio&&e(T.slice.actions.setAspectRatio(a.aspectRatio)),void 0!==a.resizeMode&&e(T.slice.actions.setResizeMode(a.resizeMode)),void 0!==a.blurRadius&&e(T.slice.actions.setBlurRadius(a.blurRadius)),void 0!==a.lightAdjustment&&e(T.slice.actions.setLightAdjustment(a.lightAdjustment)),void 0!==a.mediaProcessorsNoiseSuppression&&e(T.slice.actions.setMediaProcessorsNoiseSuppression(a.mediaProcessorsNoiseSuppression)),void 0!==a.apiUrl&&null!==a.apiUrl&&e(T.slice.actions.setApiUrl(a.apiUrl)),void 0!==a.role&&e(T.slice.actions.setRole(a.role)),void 0!==a.audioStreamingLanguageCode&&e(T.slice.actions.setAudioStreamingLanguageCode(a.audioStreamingLanguageCode)),e(T.slice.actions.setInitialFakeContents());let{audioStreamingLanguageCode:l,bundleId:r,clientId:u,dataChannelSignaling:m,dataChannels:h,ignoreDisconnectWebSocket:p,metadata:v,signalingNotifyMetadata:x,signalingUrlCandidates:j,forwardingFilter:f,videoVP9Params:b,videoH264Params:y,videoH265Params:N,videoAV1Params:k}=t();""!==r&&e(T.slice.actions.setEnabledBundleId(!0)),""!==u&&e(T.slice.actions.setEnabledClientId(!0)),""!==v&&e(T.slice.actions.setEnabledMetadata(!0)),""!==x&&e(T.slice.actions.setEnabledSignalingNotifyMetadata(!0)),0<j.length&&e(T.slice.actions.setEnabledSignalingUrlCandidates(!0)),""!==f&&e(T.slice.actions.setEnabledForwardingFilter(!0)),(""!==m||""!==p)&&e(T.slice.actions.setEnabledDataChannel(!0)),""!==h&&e(T.slice.actions.setEnabledDataChannels(!0)),""!==l&&e(T.slice.actions.setEnabledAudioStreamingLanguageCode(!0)),""!==b&&e(T.slice.actions.setEnabledVideoVP9Params(!0)),""!==y&&e(T.slice.actions.setEnabledVideoH264Params(!0)),""!==N&&e(T.slice.actions.setEnabledVideoH265Params(!0)),""!==k&&e(T.slice.actions.setEnabledVideoAV1Params(!0)),e(T.slice.actions.setSoraConnectionStatus("disconnected"))},w=()=>(e,t)=>{let a=t(),n=!("recvonly"===a.role&&("true"===a.multistream||""===a.multistream)),i={channelId:a.channelId,role:a.role,audio:a.audio,video:a.video,debug:a.debug,mediaType:"getUserMedia"!==a.mediaType?a.mediaType:void 0,audioBitRate:n&&""!==a.audioBitRate?a.audioBitRate:void 0,audioCodecType:n&&""!==a.audioCodecType?a.audioCodecType:void 0,videoBitRate:n&&""!==a.videoBitRate?a.videoBitRate:void 0,videoCodecType:n&&""!==a.videoCodecType?a.videoCodecType:void 0,videoVP9Params:n&&""!==a.videoVP9Params&&a.enabledVideoVP9Params?a.videoVP9Params:void 0,videoH264Params:n&&""!==a.videoH264Params&&a.enabledVideoH264Params?a.videoH264Params:void 0,videoH265Params:n&&""!==a.videoH265Params&&a.enabledVideoH265Params?a.videoH265Params:void 0,videoAV1Params:n&&""!==a.videoAV1Params&&a.enabledVideoAV1Params?a.videoAV1Params:void 0,audioContentHint:""!==a.audioContentHint?a.audioContentHint:void 0,autoGainControl:""!==a.autoGainControl?a.autoGainControl:void 0,noiseSuppression:""!==a.noiseSuppression?a.noiseSuppression:void 0,echoCancellation:""!==a.echoCancellation?a.echoCancellation:void 0,echoCancellationType:""!==a.echoCancellationType?a.echoCancellationType:void 0,videoContentHint:""!==a.videoContentHint?a.videoContentHint:void 0,resolution:""!==a.resolution?a.resolution:void 0,facingMode:""!==a.facingMode?a.facingMode:void 0,frameRate:""!==a.frameRate?a.frameRate:void 0,aspectRatio:""!==a.aspectRatio?a.aspectRatio:void 0,resizeMode:""!==a.resizeMode?a.resizeMode:void 0,blurRadius:""!==a.blurRadius?a.blurRadius:void 0,lightAdjustment:""!==a.lightAdjustment?a.lightAdjustment:void 0,multistream:""!==a.multistream?a.multistream:void 0,simulcast:""!==a.simulcast?a.simulcast:void 0,simulcastRid:""!==a.simulcastRid?a.simulcastRid:void 0,spotlight:""!==a.spotlight?a.spotlight:void 0,spotlightNumber:""!==a.spotlightNumber?a.spotlightNumber:void 0,spotlightFocusRid:""!==a.spotlightFocusRid?a.spotlightFocusRid:void 0,spotlightUnfocusRid:""!==a.spotlightUnfocusRid?a.spotlightUnfocusRid:void 0,audioInput:"getUserMedia"===a.mediaType&&""!==a.audioInput?a.audioInput:void 0,audioOutput:""!==a.audioOutput?a.audioOutput:void 0,videoInput:"getUserMedia"===a.mediaType&&""!==a.videoInput?a.videoInput:void 0,displayResolution:""!==a.displayResolution?a.displayResolution:void 0,mediaStats:!0===a.mediaStats||void 0,bundleId:""!==a.bundleId&&a.enabledBundleId?a.bundleId:void 0,clientId:""!==a.clientId&&a.enabledClientId?a.clientId:void 0,metadata:""!==a.metadata&&a.enabledMetadata?a.metadata:void 0,signalingNotifyMetadata:""!==a.signalingNotifyMetadata&&a.enabledSignalingNotifyMetadata?a.signalingNotifyMetadata:void 0,forwardingFilter:""!==a.forwardingFilter&&a.enabledForwardingFilter?a.forwardingFilter:void 0,dataChannelSignaling:""!==a.dataChannelSignaling&&a.enabledDataChannel?a.dataChannelSignaling:void 0,ignoreDisconnectWebSocket:""!==a.ignoreDisconnectWebSocket&&a.enabledDataChannel?a.ignoreDisconnectWebSocket:void 0,dataChannels:""!==a.dataChannels&&a.enabledDataChannels?a.dataChannels:void 0,reconnect:!0===a.reconnect||void 0,mediaProcessorsNoiseSuppression:!0===a.mediaProcessorsNoiseSuppression||void 0,micDevice:!1!==a.micDevice&&void 0,cameraDevice:!1!==a.cameraDevice&&void 0,audioTrack:!1!==a.audioTrack&&void 0,videoTrack:!1!==a.videoTrack&&void 0,signalingUrlCandidates:0<a.signalingUrlCandidates.length&&a.enabledSignalingUrlCandidates?a.signalingUrlCandidates:void 0,apiUrl:null!==a.apiUrl?a.apiUrl:void 0,fakeVolume:"fakeMedia"===a.mediaType?a.fakeVolume:void 0,mute:!0===a.mute||void 0,audioStreamingLanguageCode:n&&""!==a.audioStreamingLanguageCode&&a.enabledAudioStreamingLanguageCode?a.audioStreamingLanguageCode:void 0},s=Object.keys(i).map(e=>{let t=i[e];return void 0===t?void 0:"signalingUrlCandidates"===e?"".concat(e,"=").concat(encodeURIComponent(JSON.stringify(t))):"".concat(e,"=").concat(encodeURIComponent(t))}).filter(e=>void 0!==e);m("".concat(location.origin).concat(location.pathname,"?").concat(s.join("&"))),window.history.replaceState(null,"","".concat(location.pathname,"?").concat(s.join("&")))};async function R(e,t){let a="MEDIA_CONSTRAINTS";if("getDisplayMedia"===t.mediaType){if(!t.video||!t.cameraDevice)return[new MediaStream,null];if(void 0===navigator.mediaDevices)throw Error("Failed to call getUserMedia. Make sure domain is secure");let n={audio:j({audio:t.audio,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression,echoCancellation:t.echoCancellation,echoCancellationType:t.echoCancellationType}),video:f({frameRate:t.frameRate,resolution:t.resolution,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode})};e(T.slice.actions.setLogMessages({title:a,description:JSON.stringify(n)})),e(T.slice.actions.setTimelineMessage(P("media-constraints",n)));let i=await navigator.mediaDevices.getDisplayMedia(n);for(let a of(e(T.slice.actions.setTimelineMessage(P("succeed-get-display-media"))),i.getVideoTracks()))void 0!==a.contentHint&&(a.contentHint=t.videoContentHint),a.enabled=t.videoTrack,e(T.slice.actions.setTimelineMessage(V("start",a)));return[i,null]}if("mediacaptureRegion"===t.mediaType){if(!t.video||!t.cameraDevice)return[new MediaStream,null];if(void 0===window.CropTarget)throw Error("Failed to call CropTarget");if(void 0===navigator.mediaDevices)throw Error("Failed to call getDisplayMedia. Make sure domain is secure");let n={audio:j({audio:t.audio,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression,echoCancellation:t.echoCancellation,echoCancellationType:t.echoCancellationType}),video:f({frameRate:t.frameRate,resolution:t.resolution,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode})};n.preferCurrentTab=!0,e(T.slice.actions.setLogMessages({title:a,description:JSON.stringify(n)})),e(T.slice.actions.setTimelineMessage(P("media-constraints",n)));let i=await navigator.mediaDevices.getDisplayMedia(n),s=document.querySelector("#cropArea");if(null===s)throw Error("Failed to get CropTraget Element");let o=await window.CropTarget.fromElement(s);for(let a of(e(T.slice.actions.setTimelineMessage(P("succeed-get-display-media"))),i.getVideoTracks()))void 0!==a.contentHint&&(a.contentHint=t.videoContentHint),a.enabled=t.videoTrack,await a.cropTo(o),e(T.slice.actions.setTimelineMessage(V("start",a)));return[i,null]}if("fakeMedia"===t.mediaType&&t.fakeContents.worker){let n=function(e){let{audio:t,video:a,frameRate:n,resolution:i,volume:s,aspectRatio:o,resizeMode:l}=e,r=Number.parseInt(n,10),c=Number.isNaN(r)?30:r,d=v(i),u=d.width||240,m={audio:t,video:a,frameRate:c,width:u,height:d.height||160,fontSize:Math.floor(u/5),volume:Number.parseFloat(s)};return a&&(o||l)&&(m.videoTrackConstraints={},o&&(m.videoTrackConstraints.aspectRatio=x(o)),l&&(m.videoTrackConstraints.resizeMode=l)),m}({audio:t.audio&&t.micDevice,video:t.video&&t.cameraDevice,frameRate:t.frameRate,resolution:t.resolution,volume:t.fakeVolume,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode});e(T.slice.actions.setLogMessages({title:a,description:JSON.stringify(n)})),e(T.slice.actions.setTimelineMessage(P("media-constraints",n)));let{canvas:i,mediaStream:s,gainNode:o}=function(e){let t=new MediaStream,a=null;if(e.video){(a=document.createElement("canvas")).getContext("2d"),a.width=e.width,a.height=e.height;let n=a.captureStream(e.frameRate).getTracks()[0];e.videoTrackConstraints&&n.applyConstraints(e.videoTrackConstraints),t.addTrack(n)}let n=null;if(e.audio){let a=new(window.AudioContext||window.webkitAudioContext),i=a.createOscillator();i.type="sine",n=a.createGain(),i.connect(n),i.start(0);let s=a.createMediaStreamDestination();n.connect(s);let o=s.stream.getTracks();t.addTrack(o[0]),n.gain.setValueAtTime(e.volume,0)}return{canvas:a,mediaStream:t,gainNode:n}}(n);for(let a of(null!==i&&(t.fakeContents.worker.onmessage=e=>{let a=e.data;"update"===a.type&&function(e,t,a,n){if(null===e)return;let i=e.getContext("2d");if(!i)return;i.globalCompositeOperation="source-over",i.clearRect(0,0,e.width,e.height),i.fillStyle="#".concat(("0".repeat(6)+t.toString(16)).slice(-6)),i.fillRect(0,0,e.width,e.height),i.fillStyle="#".concat(("0".repeat(6)+(16777215-t).toString(16)).slice(-6)),i.font="".concat(a,"px Arial");let s=e.width/2-a/2,o=a/4*(n.length-1),l=e.height/2+a/2.5;i.fillText(n,s-o,l)}(i,t.fakeContents.colorCode,n.fontSize,a.counter.toString())},t.fakeContents.worker.postMessage({type:"stop"}),t.fakeContents.worker.postMessage({type:"start",interval:1e3/n.frameRate})),s.getVideoTracks()))void 0!==a.contentHint&&(a.contentHint=t.videoContentHint),a.enabled=t.videoTrack,e(T.slice.actions.setTimelineMessage(V("start",a)));for(let a of s.getAudioTracks())void 0!==a.contentHint&&(a.contentHint=t.audioContentHint),a.enabled=t.audioTrack,e(T.slice.actions.setTimelineMessage(V("start",a)));return e(T.slice.actions.setTimelineMessage(P("succeed-create-fake-media"))),[s,o]}if(void 0===navigator.mediaDevices)throw Error("Failed to call getUserMedia. Make sure domain is secure");let n=new MediaStream,i=function(e){let{audio:t,autoGainControl:a,noiseSuppression:n,echoCancellation:i,echoCancellationType:s,audioInput:o}=e;if(!t)return!1;if(!a&&!n&&!i&&!s&&!o)return t;let l={};o&&(l.deviceId={exact:o});let r=C(a);void 0!==r&&(l.autoGainControl=r);let c=C(n);void 0!==c&&(l.noiseSuppression=c);let d=C(i);return void 0!==d&&(l.echoCancellation=d),s&&(l.echoCancellationType=s),l}({audio:t.audio&&t.micDevice,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression,echoCancellation:t.echoCancellation,echoCancellationType:t.echoCancellationType,audioInput:t.audioInput}),r=function(e){let{video:t,frameRate:a,resolution:n,videoInput:i,aspectRatio:s,resizeMode:o,facingMode:l}=e;if(!t)return!1;if(!a&&!n&&!i&&!s&&!o&&!l)return t;let r={};if(a){let e=Number.parseInt(a,10);Number.isNaN(e)||(r.frameRate={min:e,max:e})}if(n){let{width:e,height:t}=v(n);0<e&&0<t&&(r.width={exact:e},r.height={exact:t})}return i&&(r.deviceId={exact:i}),s&&(r.aspectRatio=x(s)),o&&(r.resizeMode=o),"front"===l?r.facingMode="user":"back"===l&&(r.facingMode={exact:"environment"}),r}({aspectRatio:t.aspectRatio,frameRate:t.frameRate,resizeMode:t.resizeMode,resolution:t.resolution,video:t.video&&t.cameraDevice,videoInput:t.videoInput,facingMode:t.facingMode});if(i||r){let c={};i&&(c.audio=i),r&&(c.video=r),e(T.slice.actions.setLogMessages({title:a,description:JSON.stringify(c)})),e(T.slice.actions.setTimelineMessage(P("media-constraints",c)));let d=await navigator.mediaDevices.getUserMedia(c).catch(e=>{throw n.getTracks().filter(e=>{e.stop()}),e});if(i){let a=d.getAudioTracks()[0];if(e(T.slice.actions.setTimelineMessage(V("start",a))),t.mediaProcessorsNoiseSuppression&&o.b.isSupported()){if(null===t.noiseSuppressionProcessor)throw Error("Failed to start NoiseSuppressionProcessor. NoiseSuppressionProcessor is 'null'");t.noiseSuppressionProcessor.stopProcessing(),a=await t.noiseSuppressionProcessor.startProcessing(a)}e(T.slice.actions.setTimelineMessage(P("succeed-audio-get-user-media"))),n.addTrack(a)}if(r){let a=d.getVideoTracks()[0];if(e(T.slice.actions.setTimelineMessage(V("start",a))),""!==t.lightAdjustment&&s.jA.isSupported()){if(null===t.lightAdjustmentProcessor)throw Error("Failed to start LightAdjustmentProcessor. LightAdjustmentProcessor is 'null'");let e=function(e){switch(e){case"weak":return{adjustmentLevel:30,sharpnessLevel:0};case"medium":return{adjustmentLevel:50,sharpnessLevel:10,focusMask:new s.MH("https://cdn.jsdelivr.net/npm/@shiguredo/light-adjustment@latest/dist")};case"strong":return{adjustmentLevel:70,sharpnessLevel:20,minIntensity:10,focusMask:new s.MH("https://cdn.jsdelivr.net/npm/@shiguredo/light-adjustment@latest/dist")};default:return{}}}(t.lightAdjustment);t.lightAdjustmentProcessor.stopProcessing(),a=await t.lightAdjustmentProcessor.startProcessing(a,e)}if(""!==t.blurRadius&&l.sz.isSupported()){if(null===t.virtualBackgroundProcessor)throw Error("Failed to start VirtualBackgroundProcessor. VirtualBackgroundProcessor is 'null'");let e={blurRadius:function(e){switch(e){case"weak":return 5;case"medium":return 10;case"strong":return 15;default:return 0}}(t.blurRadius)};t.virtualBackgroundProcessor.stopProcessing(),a=await t.virtualBackgroundProcessor.startProcessing(a,e)}e(T.slice.actions.setTimelineMessage(P("succeed-video-get-user-media"))),n.addTrack(a)}}for(let e of n.getVideoTracks())void 0!==e.contentHint&&(e.contentHint=t.videoContentHint),e.enabled=t.videoTrack;for(let e of n.getAudioTracks())void 0!==e.contentHint&&(e.contentHint=t.audioContentHint),e.enabled=t.audioTrack;return[n,null]}function Z(e,t,a){a.on("log",(t,a)=>{e(T.slice.actions.setLogMessages({title:t,description:JSON.stringify(a)}))}),a.on("notify",(a,n)=>{var i;"spotlight.focused"===a.event_type&&"string"==typeof a.connection_id&&e(T.slice.actions.setFocusedSpotlightConnectionId(a.connection_id)),"spotlight.unfocused"===a.event_type&&"string"==typeof a.connection_id&&e(T.slice.actions.setUnFocusedSpotlightConnectionId(a.connection_id)),"connection.destroyed"===a.event_type&&"string"==typeof a.connection_id&&e(T.slice.actions.deleteFocusedSpotlightConnectionId(a.connection_id));let{soraContents:s}=t();if("connection.created"===a.event_type&&"string"==typeof a.connection_id&&a.connection_id===(null===(i=s.sora)||void 0===i?void 0:i.connectionId)){if("string"==typeof a.session_id&&e(T.slice.actions.setSoraSessionId(a.session_id)),"string"==typeof a.connection_id&&e(T.slice.actions.setSoraConnectionId(a.connection_id)),"string"==typeof a.client_id&&e(T.slice.actions.setSoraClientId(a.client_id)),Array.isArray(a.data))for(let t of a.data)"string"==typeof t.connection_id&&"string"==typeof t.client_id&&e(T.slice.actions.setSoraRemoteClientId({connectionId:t.connection_id,clientId:t.client_id}))}else"connection.created"===a.event_type&&"string"==typeof a.connection_id&&"string"==typeof a.client_id&&e(T.slice.actions.setSoraRemoteClientId({connectionId:a.connection_id,clientId:a.client_id}));e(T.slice.actions.setNotifyMessages({timestamp:new Date().getTime(),message:a,transportType:n}))}),a.on("push",(t,a)=>{e(T.slice.actions.setPushMessages({timestamp:new Date().getTime(),message:t,transportType:a}))}),a.on("track",a=>{e(T.slice.actions.setTimelineMessage(P("event-on-track")));let{soraContents:n}=t();if(!n.remoteClients.find(e=>e.connectionId===a.streams[0].id)){for(let t of a.streams[0].getTracks())e(T.slice.actions.setTimelineMessage(P("remote-".concat(t.kind,"-mediastream-track"),N(t))));e(T.slice.actions.setRemoteClient({mediaStream:a.streams[0],connectionId:a.streams[0].id,clientId:null}))}}),a.on("removetrack",a=>{e(T.slice.actions.setTimelineMessage(P("event-on-removetrack")));let{soraContents:n}=t(),i=n.remoteClients.find(e=>{if(null==a?void 0:a.target)return e.connectionId===a.target.id});i&&e(T.slice.actions.removeRemoteClient(i.connectionId))}),a.on("disconnect",a=>{let n={type:a.type,title:a.title};void 0!==a.code&&(n.code=a.code),void 0!==a.reason&&(n.reason=a.reason),void 0!==a.params&&(n.params=a.params),e(T.slice.actions.setTimelineMessage(P("event-on-disconnect",n)));let{fakeContents:i,soraContents:s,reconnect:o,lightAdjustmentProcessor:l,virtualBackgroundProcessor:r,noiseSuppressionProcessor:c}=t(),{localMediaStream:d,remoteClients:u}=s,m=J(l,r);(async()=>{await z(e,d,m)})(),G(e,d,c),u.filter(e=>{e.mediaStream.getTracks().filter(e=>{e.stop()})}),i.worker&&i.worker.postMessage({type:"stop"}),e(T.slice.actions.setSora(null)),e(T.slice.actions.setSoraSessionId(null)),e(T.slice.actions.setSoraConnectionId(null)),e(T.slice.actions.setSoraClientId(null)),e(T.slice.actions.setSoraTurnUrl(null)),e(T.slice.actions.setSoraConnectionStatus("disconnected")),e(T.slice.actions.setLocalMediaStream(null)),e(T.slice.actions.removeAllRemoteClients()),e(T.slice.actions.setSoraInfoAlertMessage("Disconnect Sora.")),e(T.slice.actions.setTimelineMessage(P("disconnected"))),"abend"===a.type&&o&&e(T.slice.actions.setSoraReconnecting(!0))}),a.on("timeline",t=>{let a={timestamp:new Date().getTime(),type:t.type,data:t.data,dataChannelId:t.dataChannelId,dataChannelLabel:t.dataChannelLabel,logType:t.logType};e(T.slice.actions.setTimelineMessage(a)),t.data&&"object"==typeof t.data&&"sdp"in t.data&&e(T.slice.actions.setTimelineMessage(P("".concat(t.type,"-sdp"),t.data.sdp)))}),a.on("signaling",t=>{let a={timestamp:new Date().getTime(),transportType:t.transportType,type:t.type,data:t.data};e(T.slice.actions.setSignalingMessage(a))}),a.on("message",t=>{e(T.slice.actions.setDataChannelMessage({timestamp:new Date().getTime(),label:t.label,data:t.data}))}),a.on("datachannel",t=>{e(T.slice.actions.setSoraDataChannels(t.datachannel))})}function M(e){return{audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,audioStreamingLanguageCode:e.audioStreamingLanguageCode,bundleId:e.bundleId,clientId:e.clientId,dataChannelSignaling:e.dataChannelSignaling,dataChannels:e.enabledDataChannels?e.dataChannels:"",enabledAudioStreamingLanguageCode:e.enabledAudioStreamingLanguageCode,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,enabledForwardingFilter:e.enabledForwardingFilter,enabledVideoVP9Params:e.enabledVideoVP9Params,enabledVideoH264Params:e.enabledVideoH264Params,enabledVideoH265Params:e.enabledVideoH265Params,enabledVideoAV1Params:e.enabledVideoAV1Params,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,multistream:e.multistream,signalingNotifyMetadata:e.signalingNotifyMetadata,forwardingFilter:e.forwardingFilter,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType,videoVP9Params:e.videoVP9Params,videoH264Params:e.videoH264Params,videoH265Params:e.videoH265Params,videoAV1Params:e.videoAV1Params,role:e.role}}function P(e,t){return{type:e,logType:"sora-devtools",timestamp:new Date().getTime(),data:t}}function V(e,t){let a=N(t);return P("".concat(e,"-").concat(t.kind,"-mediastream-track"),a)}async function D(e,t){var a;if(t.pc&&(null===(a=t.pc)||void 0===a?void 0:a.iceConnectionState)!=="closed"){let a=await t.pc.getStats(),n=[],i=[];for(let t of(a.forEach(e=>{n.push(e),"local-candidate"===e.type&&i.push(e)}),e(T.slice.actions.setStatsReport(n)),i))if(void 0!==t.url){e(T.slice.actions.setSoraTurnUrl(t.url));break}}}let A=()=>async(e,t)=>{let a,n;let i=t();try{[a,n]=await R(e,i).catch(e=>{throw e})}catch(n){var s,o,l;let t;if(n instanceof Error&&(e(T.slice.actions.setLogMessages({title:"REQUEST_MEDIA",description:JSON.stringify(n.message)})),e(T.slice.actions.setAPIErrorAlertMessage("Failed to get user devices. ".concat(n.message)))),(null===(s=i.lightAdjustmentProcessor)||void 0===s?void 0:s.isProcessing())&&(t=i.lightAdjustmentProcessor.getOriginalTrack(),i.lightAdjustmentProcessor.stopProcessing()),(null===(o=i.virtualBackgroundProcessor)||void 0===o?void 0:o.isProcessing())&&(void 0===t&&(t=i.virtualBackgroundProcessor.getOriginalTrack()),i.virtualBackgroundProcessor.stopProcessing()),t?(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))):a&&a.getVideoTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))}),null===(l=i.noiseSuppressionProcessor)||void 0===l?void 0:l.isProcessing()){let t=i.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))),i.noiseSuppressionProcessor.stopProcessing()}else a&&a.getAudioTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))});throw n}n&&e(T.slice.actions.setFakeContentsGainNode(n)),e(T.slice.actions.setLocalMediaStream(a))},F=()=>async(e,t)=>{let a;let{fakeContents:n,soraContents:i,lightAdjustmentProcessor:s,noiseSuppressionProcessor:o,virtualBackgroundProcessor:l}=t(),{localMediaStream:r}=i;if((null==s?void 0:s.isProcessing())&&(a=s.getOriginalTrack(),s.stopProcessing()),(null==l?void 0:l.isProcessing())&&(void 0===a&&(a=l.getOriginalTrack()),l.stopProcessing()),void 0!==a?(a.stop(),null==r||r.removeTrack(a),e(T.slice.actions.setTimelineMessage(V("stop",a)))):r&&r.getVideoTracks().filter(t=>{t.stop(),r.removeTrack(t),e(T.slice.actions.setTimelineMessage(V("stop",t)))}),null==o?void 0:o.isProcessing()){let t=o.getOriginalTrack();t&&(t.stop(),null==r||r.removeTrack(t),e(T.slice.actions.setTimelineMessage(V("stop",t)))),o.stopProcessing()}else r&&r.getAudioTracks().filter(t=>{t.stop(),r.removeTrack(t),e(T.slice.actions.setTimelineMessage(V("stop",t)))});n.worker&&n.worker.postMessage({type:"stop"}),e(T.slice.actions.setLocalMediaStream(null))},O=()=>async(e,t)=>{let a,n,i;e(T.slice.actions.setTimelineMessage(P("start-connection"))),e(T.slice.actions.setSoraConnectionStatus("preparing"));let s=t(),o=!1;s.soraContents.sora&&(await s.soraContents.sora.disconnect(),o=!0);let l=h(s.enabledSignalingUrlCandidates,s.signalingUrlCandidates);e(T.slice.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(l)}));let c=r.Z.connection(l,s.debug),d=k(M(s)),u=b(s.enabledMetadata,s.metadata);try{"sendonly"===s.role?((a=c.sendonly(s.channelId,null,d)).metadata=u,"boolean"==typeof s.googCpuOveruseDetection&&(a.constraints={optional:[{googCpuOveruseDetection:s.googCpuOveruseDetection}]}),Z(e,t,a),!o&&s.soraContents.localMediaStream?n=s.soraContents.localMediaStream:[n,i]=await R(e,s).catch(t=>{throw e(T.slice.actions.setSoraErrorAlertMessage(t.toString())),e(T.slice.actions.setSoraConnectionStatus("disconnected")),t}),e(T.slice.actions.setSoraConnectionStatus("connecting")),e(T.slice.actions.setSora(a)),await a.connect(n)):"sendrecv"===s.role?((a=c.sendrecv(s.channelId,null,d)).metadata=u,"boolean"==typeof s.googCpuOveruseDetection&&(a.constraints={optional:[{googCpuOveruseDetection:s.googCpuOveruseDetection}]}),Z(e,t,a),!o&&s.soraContents.localMediaStream?n=s.soraContents.localMediaStream:[n,i]=await R(e,s).catch(t=>{throw e(T.slice.actions.setSoraErrorAlertMessage(t.toString())),e(T.slice.actions.setSoraConnectionStatus("disconnected")),t}),e(T.slice.actions.setSora(a)),await a.connect(n)):"recvonly"===s.role&&((a=c.recvonly(s.channelId,null,d)).metadata=u,Z(e,t,a),e(T.slice.actions.setSoraConnectionStatus("connecting")),e(T.slice.actions.setSora(a)),await a.connect())}catch(a){var m,g,p;let t;if(e(T.slice.actions.setSora(null)),a instanceof Error&&e(T.slice.actions.setSoraErrorAlertMessage("Failed to connect Sora. ".concat(a.message))),(null===(m=s.lightAdjustmentProcessor)||void 0===m?void 0:m.isProcessing())&&(t=s.lightAdjustmentProcessor.getOriginalTrack(),s.lightAdjustmentProcessor.stopProcessing()),(null===(g=s.virtualBackgroundProcessor)||void 0===g?void 0:g.isProcessing())&&(void 0===t&&(t=s.virtualBackgroundProcessor.getOriginalTrack()),s.virtualBackgroundProcessor.stopProcessing()),t?(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))):n&&n.getVideoTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))}),null===(p=s.noiseSuppressionProcessor)||void 0===p?void 0:p.isProcessing()){let t=s.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))),s.noiseSuppressionProcessor.stopProcessing()}else n&&n.getAudioTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))});throw e(T.slice.actions.setSoraConnectionStatus("disconnected")),a}if(void 0===a)throw Error("Failed to connect Sora. Connection object is 'undefined'");e(T.slice.actions.setSoraInfoAlertMessage("Succeeded to connect Sora.")),await D(e,a);let v=setInterval(async()=>{let{soraContents:a}=t();a.sora?await D(e,a.sora):clearInterval(v)},1e3);a.stream=null,n&&(null===s.soraContents.localMediaStream||o)&&e(T.slice.actions.setLocalMediaStream(n)),i&&e(T.slice.actions.setFakeContentsGainNode(i)),e(T.slice.actions.setSoraConnectionStatus("connected")),e(T.slice.actions.setTimelineMessage(P("connected")))},H=()=>async(e,t)=>{let a,n,i;e(T.slice.actions.setTimelineMessage(P("start-reconnect"))),e(T.slice.actions.setSoraConnectionStatus("connecting"));let s=t();s.soraContents.sora&&"connected"===s.soraContents.connectionStatus&&await s.soraContents.sora.disconnect();let o=h(s.enabledSignalingUrlCandidates,s.signalingUrlCandidates);e(T.slice.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(o)}));let l=r.Z.connection(o,s.debug),c=k(M(s)),d=b(s.enabledMetadata,s.metadata);("sendonly"===s.role||"sendrecv"===s.role)&&([n,i]=await R(e,s).catch(t=>{throw e(T.slice.actions.setSoraErrorAlertMessage(t.toString())),e(T.slice.actions.setSoraConnectionStatus("disconnected")),t}));for(let i=1;i<=10;i++){let{soraContents:o}=t();if(!1===o.reconnecting)break;e(T.slice.actions.setSoraReconnectingTrials(i));try{"sendonly"===s.role?((a=l.sendonly(s.channelId,null,c)).metadata=d,"boolean"==typeof s.googCpuOveruseDetection&&(a.constraints={optional:[{googCpuOveruseDetection:s.googCpuOveruseDetection}]}),Z(e,t,a),n&&await a.connect(n)):"sendrecv"===s.role?((a=l.sendrecv(s.channelId,null,c)).metadata=d,"boolean"==typeof s.googCpuOveruseDetection&&(a.constraints={optional:[{googCpuOveruseDetection:s.googCpuOveruseDetection}]}),Z(e,t,a),n&&await a.connect(n)):"recvonly"===s.role&&((a=l.recvonly(s.channelId,null,c)).metadata=d,Z(e,t,a),await a.connect())}catch(t){t instanceof Error&&e(T.slice.actions.setSoraErrorAlertMessage("(trials ".concat(i,") Failed to connect Sora. ").concat(t.message))),a=void 0}if(void 0!==a)break;await new Promise(e=>setTimeout(e,500*i+500))}if(void 0===a){e(T.slice.actions.setSoraErrorAlertMessage("Failed to reconnect Sora.")),e(T.slice.actions.setSoraConnectionStatus("disconnected")),e(T.slice.actions.setSoraReconnecting(!1));return}e(T.slice.actions.setSoraInfoAlertMessage("Succeeded to reconnect Sora.")),await D(e,a);let u=setInterval(async()=>{let{soraContents:a}=t();a.sora?await D(e,a.sora):clearInterval(u)},1e3);e(T.slice.actions.setSora(a)),n&&e(T.slice.actions.setLocalMediaStream(n)),i&&e(T.slice.actions.setFakeContentsGainNode(i)),e(T.slice.actions.setSoraConnectionStatus("connected")),e(T.slice.actions.setTimelineMessage(P("connected"))),e(T.slice.actions.setSoraReconnecting(!1))},U=()=>async(e,t)=>{let{soraContents:a}=t();a.sora&&"connected"===a.connectionStatus&&(e(T.slice.actions.setSoraConnectionStatus("disconnecting")),await a.sora.disconnect(),e(T.slice.actions.setSoraConnectionStatus("disconnected")))},B=()=>async(e,t)=>{let a=await S(),n=[],i=[],s=[];a.filter(e=>{""!==e.deviceId&&("audioinput"===e.kind?n.push(e.toJSON()):"audiooutput"===e.kind?s.push(e.toJSON()):"videoinput"===e.kind&&i.push(e.toJSON()))}),e(T.slice.actions.setAudioInputDevices(n)),e(T.slice.actions.setVideoInputDevices(i)),e(T.slice.actions.setAudioOutputDevices(s))},E=()=>async(e,t)=>{var a,n;let i=t();if(!i.soraContents.localMediaStream)return;if(null===(a=i.virtualBackgroundProcessor)||void 0===a?void 0:a.isProcessing()){let t=i.virtualBackgroundProcessor.getOriginalTrack();t&&(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))),i.virtualBackgroundProcessor.stopProcessing()}else i.soraContents.localMediaStream&&i.soraContents.localMediaStream.getVideoTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))});if(null===(n=i.noiseSuppressionProcessor)||void 0===n?void 0:n.isProcessing()){let t=i.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))),i.noiseSuppressionProcessor.stopProcessing()}else i.soraContents.localMediaStream&&i.soraContents.localMediaStream.getAudioTracks().filter(t=>{t.stop(),e(T.slice.actions.setTimelineMessage(V("stop",t)))});let[s,o]=await R(e,i).catch(t=>{throw e(T.slice.actions.setSoraErrorAlertMessage(t.toString())),e(T.slice.actions.setSoraConnectionStatus("disconnected")),t});s.getTracks().filter(e=>{if(!i.soraContents.sora||!i.soraContents.sora.pc)return;let t=i.soraContents.sora.pc.getSenders().find(t=>!!t.track&&t.track.kind===e.kind);t&&t.replaceTrack(e)}),e(T.slice.actions.setLocalMediaStream(s)),e(T.slice.actions.setFakeContentsGainNode(o))},_=e=>async(t,a)=>{let n=a();if(!n.soraContents.localMediaStream||!n.soraContents.sora){t(T.slice.actions.setMicDevice(e));return}if(e){let a={aspectRatio:n.aspectRatio,audio:n.audio,audioContentHint:n.audioContentHint,audioInput:n.audioInput,audioTrack:n.audioTrack,autoGainControl:n.autoGainControl,blurRadius:n.blurRadius,cameraDevice:n.cameraDevice,echoCancellation:n.echoCancellation,echoCancellationType:n.echoCancellationType,facingMode:n.facingMode,fakeContents:n.fakeContents,fakeVolume:n.fakeVolume,frameRate:n.frameRate,lightAdjustment:n.lightAdjustment,lightAdjustmentProcessor:n.lightAdjustmentProcessor,mediaProcessorsNoiseSuppression:n.mediaProcessorsNoiseSuppression,mediaType:n.mediaType,micDevice:e,noiseSuppression:n.noiseSuppression,noiseSuppressionProcessor:n.noiseSuppressionProcessor,resizeMode:n.resizeMode,resolution:n.resolution,video:!1,videoContentHint:n.videoContentHint,videoInput:n.videoInput,videoTrack:n.videoTrack,virtualBackgroundProcessor:n.virtualBackgroundProcessor},[i,s]=await R(t,a).catch(e=>{throw t(T.slice.actions.setSoraErrorAlertMessage(e.toString())),e});0<i.getAudioTracks().length&&(n.soraContents.sora&&"connected"===n.soraContents.connectionStatus&&n.soraContents.localMediaStream?await n.soraContents.sora.replaceAudioTrack(n.soraContents.localMediaStream,i.getAudioTracks()[0]):n.soraContents.localMediaStream&&(n.soraContents.localMediaStream.getAudioTracks().filter(e=>{var t;e.enabled=!1,e.stop(),null===(t=n.soraContents.localMediaStream)||void 0===t||t.removeTrack(e)}),n.soraContents.localMediaStream.addTrack(i.getAudioTracks()[0])),t(T.slice.actions.setFakeContentsGainNode(s)))}else n.soraContents.sora&&"connected"===n.soraContents.connectionStatus&&n.soraContents.localMediaStream?(G(t,n.soraContents.localMediaStream,n.noiseSuppressionProcessor),n.soraContents.sora.stopAudioTrack(n.soraContents.localMediaStream)):n.soraContents.localMediaStream&&G(t,n.soraContents.localMediaStream,n.noiseSuppressionProcessor);t(T.slice.actions.setMicDevice(e))},L=e=>async(t,a)=>{let n=a();if(!n.soraContents.localMediaStream&&!n.soraContents.sora&&"connected"!==n.soraContents.connectionStatus){t(T.slice.actions.setCameraDevice(e));return}if(e){let a={aspectRatio:n.aspectRatio,audio:!1,audioContentHint:n.audioContentHint,audioInput:n.audioInput,audioTrack:n.audioTrack,autoGainControl:n.autoGainControl,blurRadius:n.blurRadius,cameraDevice:e,echoCancellation:n.echoCancellation,echoCancellationType:n.echoCancellationType,facingMode:n.facingMode,fakeContents:n.fakeContents,fakeVolume:n.fakeVolume,frameRate:n.frameRate,lightAdjustment:n.lightAdjustment,lightAdjustmentProcessor:n.lightAdjustmentProcessor,mediaProcessorsNoiseSuppression:n.mediaProcessorsNoiseSuppression,mediaType:n.mediaType,micDevice:n.micDevice,noiseSuppression:n.noiseSuppression,noiseSuppressionProcessor:n.noiseSuppressionProcessor,resizeMode:n.resizeMode,resolution:n.resolution,video:n.video,videoContentHint:n.videoContentHint,videoInput:n.videoInput,videoTrack:n.videoTrack,virtualBackgroundProcessor:n.virtualBackgroundProcessor},[i,s]=await R(t,a).catch(e=>{throw t(T.slice.actions.setSoraErrorAlertMessage(e.toString())),e});0<i.getVideoTracks().length&&(n.soraContents.sora&&"connected"===n.soraContents.connectionStatus&&n.soraContents.localMediaStream?n.soraContents.sora.replaceVideoTrack(n.soraContents.localMediaStream,i.getVideoTracks()[0]):n.soraContents.localMediaStream&&(n.soraContents.localMediaStream.getVideoTracks().filter(e=>{var t;e.enabled=!1,e.stop(),null===(t=n.soraContents.localMediaStream)||void 0===t||t.removeTrack(e)}),n.soraContents.localMediaStream.addTrack(i.getVideoTracks()[0])),t(T.slice.actions.setFakeContentsGainNode(s)))}else if(n.soraContents.sora&&"connected"===n.soraContents.connectionStatus&&n.soraContents.localMediaStream){let e=J(n.lightAdjustmentProcessor,n.virtualBackgroundProcessor);await z(t,n.soraContents.localMediaStream,e),n.soraContents.sora.stopVideoTrack(n.soraContents.localMediaStream)}else if(n.soraContents.localMediaStream){let e=J(n.lightAdjustmentProcessor,n.virtualBackgroundProcessor);await z(t,n.soraContents.localMediaStream,e)}t(T.slice.actions.setCameraDevice(e))},J=(e,t)=>{let a;return(null==e?void 0:e.isProcessing())&&(a=e.getOriginalTrack(),e.stopProcessing()),(null==t?void 0:t.isProcessing())&&(void 0===a&&(a=t.getOriginalTrack()),t.stopProcessing()),a},z=async(e,t,a)=>{if(void 0!==a)a.enabled=!1,await new Promise(e=>setTimeout(e,100)),a.stop(),null==t||t.removeTrack(a),e(T.slice.actions.setTimelineMessage(V("stop",a)));else{if(!t)return;t.getVideoTracks().filter(e=>{e.enabled=!1}),await new Promise(e=>setTimeout(e,100)),t.getVideoTracks().filter(a=>{a.stop(),t.removeTrack(a),e(T.slice.actions.setTimelineMessage(V("stop",a)))})}},G=(e,t,a)=>{if(null==a?void 0:a.isProcessing()){let n=a.getOriginalTrack();n&&(n.stop(),null==t||t.removeTrack(n),e(T.slice.actions.setTimelineMessage(V("stop",n)))),a.stopProcessing()}else t&&t.getAudioTracks().filter(a=>{a.stop(),t.removeTrack(a),e(T.slice.actions.setTimelineMessage(V("stop",a)))})},{clearDataChannelMessages:W,deleteAlertMessage:K,setAPIErrorAlertMessage:q,setAPIInfoAlertMessage:Q,setAspectRatio:X,setAudio:$,setAudioBitRate:Y,setAudioCodecType:ee,setAudioContentHint:et,setAudioInput:ea,setAudioOutput:en,setAudioTrack:ei,setAutoGainControl:es,setBlurRadius:eo,setBundleId:el,setChannelId:er,setClientId:ec,setDataChannels:ed,setDataChannelSignaling:eu,setDebug:em,setDebugFilterText:eg,setDebugType:eh,setDisplayResolution:ep,setEchoCancellation:ev,setEchoCancellationType:ex,setEnabledBundleId:ej,setEnabledClientId:ef,setEnabledDataChannels:eC,setEnabledDataChannel:eb,setEnabledForwardingFilter:eS,setEnabledMetadata:ey,setEnabledSignalingNotifyMetadata:eN,setEnabledSignalingUrlCandidates:ek,setEnabledVideoVP9Params:eT,setEnabledVideoH264Params:eI,setEnabledVideoH265Params:ew,setEnabledVideoAV1Params:eR,setAudioStreamingLanguageCode:eZ,setEnabledAudioStreamingLanguageCode:eM,setFakeVolume:eP,setFacingMode:eV,setFrameRate:eD,setIgnoreDisconnectWebSocket:eA,setLightAdjustment:eF,setLocalMediaStream:eO,setLogMessages:eH,setMediaProcessorsNoiseSuppression:eU,setMediaStats:eB,setMediaType:eE,setMetadata:e_,setMultistream:eL,setNoiseSuppression:eJ,setNotifyMessages:ez,setReconnect:eG,setResizeMode:eW,setRole:eK,setResolution:eq,setSignalingNotifyMetadata:eQ,setSignalingUrlCandidates:eX,setForwardingFilter:e$,setSimulcast:eY,setSimulcastRid:e0,setSora:e1,setSoraReconnecting:e2,setSoraErrorAlertMessage:e5,setSoraInfoAlertMessage:e6,setSpotlight:e4,setSpotlightFocusRid:e9,setSpotlightNumber:e3,setSpotlightUnfocusRid:e8,setVideo:e7,setVideoBitRate:te,setVideoCodecType:tt,setVideoContentHint:ta,setVideoInput:tn,setVideoTrack:ti,setVideoVP9Params:ts,setVideoH264Params:to,setVideoH265Params:tl,setVideoAV1Params:tr}=T.slice.actions;var tc=a(3350);let td=()=>(0,tc.I0)(),tu=tc.v9;var tm=a(8570),tg=a(5838),th=a(7442);let tp=()=>(0,n.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-clipboard",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("title",{children:"ClipboardIcon"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"})]}),tv=e=>e.disabled?(0,n.jsx)("div",{style:{height:"31px"}}):(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-dark",onClick:t=>{m(e.text),t.currentTarget.blur()},children:(0,n.jsx)(tp,{})}),tx=e=>{let{description:t}=e;return void 0===t?null:"object"!=typeof t?(0,n.jsx)("div",{className:"debug-message",children:(0,n.jsx)("div",{className:"col-sm-12",children:(0,n.jsx)("pre",{className:e.wordBreak?"word-break":"",children:t})})}):(0,n.jsx)("div",{className:"debug-message",children:(0,n.jsx)("div",{className:"col-sm-12",children:(0,n.jsx)("pre",{className:e.wordBreak?"word-break":"",children:JSON.stringify(t,null,2)})})})},tj=e=>{let{defaultShow:t,description:a,title:s,timestamp:o,label:l}=e,[r,c]=(0,i.useState)(void 0!==t&&t),d=o?s+o:s,m=void 0===a;return(0,n.jsxs)("div",{className:"border border-light rounded mb-1 bg-dark","data-title":s,children:[(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center text-break",children:[(0,n.jsxs)("a",{className:"debug-title ".concat(m?"disabled":""),onClick:()=>c(!r),"aria-controls":d,"aria-expanded":r,children:[(0,n.jsx)("i",{className:"".concat(r?"arrow-bottom":"arrow-right"," ").concat(m?"disabled":"")})," ",o?(0,n.jsxs)("span",{className:"text-white-50 me-1",children:["[",u(o),"]"]}):null,l,(0,n.jsx)("span",{children:s})]}),(0,n.jsx)("div",{className:"border-left",children:(0,n.jsx)(tv,{text:"string"==typeof a?a:JSON.stringify(a,null,2),disabled:m})})]}),(0,n.jsx)(th.Z,{in:r,children:(0,n.jsx)("div",{className:"border-top",children:(0,n.jsx)(tx,{description:a,wordBreak:e.wordBreak})})})]})},tf=e=>{let{title:t,codecs:a}=e;return(0,n.jsx)(tj,{title:t,timestamp:null,description:JSON.stringify(a,null,2)})},tC=i.memo(e=>(0,n.jsx)(tf,{...e})),tb=(e,t)=>{if(!e)return[];let a=e(t);return a&&a.codecs?a.codecs:[]},tS=()=>{let e=tb(RTCRtpSender.getCapabilities,"audio"),t=tb(RTCRtpSender.getCapabilities,"video"),a=tb(RTCRtpReceiver.getCapabilities,"audio"),i=tb(RTCRtpReceiver.getCapabilities,"video");return(0,n.jsxs)("div",{className:"capabilities-codec",children:[(0,n.jsx)(tC,{title:"Audio RTCRtpSender CapabilitiesCodec",codecs:e}),(0,n.jsx)(tC,{title:"Video RTCRtpSender CapabilitiesCodec",codecs:t}),(0,n.jsx)(tC,{title:"Audio RTCRtpReceiver CapabilitiesCodec",codecs:a}),(0,n.jsx)(tC,{title:"Video RTCRtpReceiver CapabilitiesCodec",codecs:i})]})},ty=()=>{let e=td();return(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"clear",defaultValue:"clear",onClick:()=>{e(W())}})},tN=e=>{let{data:t,label:a,timestamp:i}=e;if("ZAKURO"===new TextDecoder().decode(t.slice(0,6))){let e=new TextDecoder().decode(t.slice(22,48)),s=new DataView(t),o=s.getBigInt64(6),l=s.getBigInt64(14),r=t.byteLength,c="connectionId: ".concat(e,"\nUnixTimeMicro: ").concat(o,"\nCounter: ").concat(l,"\nByteLength: ").concat(r);return(0,n.jsx)(tj,{title:"".concat(a," ZAKURO"),timestamp:i,description:c,defaultShow:!0,wordBreak:!0})}let s=new Uint8Array(t),o="".concat(s.toString(),"\n(").concat(new TextDecoder().decode(t),")");return(0,n.jsx)(tj,{title:a,timestamp:i,description:o,defaultShow:!0,wordBreak:!0})},tk=i.memo(e=>(0,n.jsx)(tN,{...e})),tT=()=>{let e=tu(e=>e.dataChannelMessages);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"py-1",children:(0,n.jsx)(ty,{})}),(0,n.jsx)("div",{className:"debug-messages",children:e.map(e=>{let t=e.label+e.timestamp;return(0,n.jsx)(tk,{...e},t)})})]})};var tI=a(8841),tw=a(853),tR=a(7587);let tZ=()=>{let e=tu(e=>e.debugFilterText),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline debug-filter",controlId:"channelId",children:[(0,n.jsx)(tw.Z,{className:"text-white",children:"Filter:"}),(0,n.jsx)(tR.Z,{type:"text",placeholder:"Filter",value:e,onChange:e=>{t(eg(e.target.value))},autoComplete:"off"})]})},tM=e=>{let{message:t,timestamp:a}=e;return(0,n.jsx)(tj,{title:t.title,timestamp:a,description:JSON.parse(t.description)})},tP=i.memo(e=>(0,n.jsx)(tM,{...e})),tV=()=>{let e=tu(e=>e.logMessages),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map((e,t)=>(0,n.jsx)(tP,{...e},e.message.title+String(t)+e.timestamp))})},tD={websocket:"#00ff00",datachannel:"#ff00ff"},tA=e=>{let{text:t}=e,a=Object.keys(tD).includes(t)?tD[t]:void 0;return(0,n.jsxs)("span",{className:"me-1",style:a?{color:a}:{},children:["[",t,"]"]})},tF=e=>{let{notify:t}=e,a=t.transportType?(0,n.jsx)(tA,{text:t.transportType}):null;return(0,n.jsx)(tj,{title:t.message.event_type,timestamp:t.timestamp,description:t.message,label:a})},tO=i.memo(e=>(0,n.jsx)(tF,{...e})),tH=()=>{let e=tu(e=>e.notifyMessages),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map(e=>(0,n.jsx)(tO,{notify:e},e.message.type+e.timestamp))})},tU={websocket:"#00ff00",datachannel:"#ff00ff"},tB=e=>{let{text:t}=e,a=Object.keys(tU).includes(t)?tU[t]:void 0;return(0,n.jsxs)("span",{style:a?{color:a}:{},children:["[",t,"]"]})},tE=e=>{let{push:t}=e,a=t.transportType?(0,n.jsx)(tB,{text:t.transportType}):null;return(0,n.jsx)(tj,{title:t.message.type,timestamp:t.timestamp,description:t.message,label:a})},t_=i.memo(e=>(0,n.jsx)(tE,{...e})),tL=()=>{let e=tu(e=>e.pushMessages),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map((e,t)=>{let a="".concat(e.timestamp,"-").concat(t);return(0,n.jsx)(t_,{ariaControls:a,push:e},a)})})};var tJ=a(3365),tz=a(3949);let tG=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),a=tu(e=>e.soraContents.sora),s=tu(e=>e.soraContents.connectionStatus),o=tu(e=>e.soraContents.datachannels);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"d-flex mt-2",children:[(0,n.jsx)(tI.Z,{className:"me-1",controlId:"sendDataChannelMessageLabel",children:(0,n.jsx)(tJ.Z,{name:"sendDataChannelMessageLabel",ref:e,children:o.map(e=>(0,n.jsx)("option",{value:e.label,children:e.label},e.label))})}),(0,n.jsx)(tI.Z,{className:"flex-grow-1 me-1",controlId:"sendDataChannelMessage",children:(0,n.jsx)(tR.Z,{className:"flex-fill",placeholder:"sendDataChannelMessage",type:"text",ref:t})}),(0,n.jsx)(tz.Z,{variant:"secondary",onClick:()=>{if(null===e.current||null===t.current)return;let n=e.current.value;a&&"connected"===s&&a.sendMessage(n,new TextEncoder().encode(t.current.value))},disabled:0===o.length,children:"send"})]}),0<o.length?(0,n.jsx)("pre",{className:"form-control mt-2",style:{color:"#fff",backgroundColor:"#222222",maxHeight:"250px",minHeight:"250px"},children:JSON.stringify(o,null,2)}):null]})},tW={websocket:"#00ff00",datachannel:"#ff00ff"},tK=e=>{let{text:t}=e,a=Object.keys(tW).includes(t)?tW[t]:void 0;return(0,n.jsxs)("span",{className:"me-1",style:a?{color:a}:{},children:["[",t,"]"]})},tq=e=>{let{data:t,type:a,timestamp:i,transportType:s}=e,o=s?(0,n.jsx)(tK,{text:s}):null;return(0,n.jsx)(tj,{title:a,timestamp:i,description:t,label:o})},tQ=i.memo(e=>(0,n.jsx)(tq,{...e})),tX=()=>{let e=tu(e=>e.signalingMessages),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map(e=>{let t=e.type+e.timestamp;return(0,n.jsx)(tQ,{...e},t)})})},t$=e=>(0,n.jsx)(tj,{title:"".concat(e.id,"(").concat(e.type,")"),timestamp:null,description:e}),tY=i.memo(e=>(0,n.jsx)(t$,{...e})),t0=()=>{let e=tu(e=>e.soraContents.statsReport),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map(e=>(0,n.jsx)(tY,{...e},e.id))})},t1={signaling:"#ff00ff",notify:"#ffff00",push:"#98fb98",stats:"#ffc0cb"},t2=()=>(0,n.jsx)("span",{className:"me-1",style:{color:"#00ff00"},children:"[websocket]"}),t5=()=>(0,n.jsx)("span",{className:"me-1",style:{color:"#ff8c00"},children:"[peerconnection]"}),t6=()=>(0,n.jsx)("span",{className:"me-1",style:{color:"#bce2e8"},children:"[sora]"}),t4=()=>(0,n.jsx)("span",{className:"me-1",style:{color:"#73b8e2"},children:"[sora-devtools]"}),t9=e=>{let{label:t,id:a}=e,i=t&&Object.keys(t1).includes(t)?t1[t]:void 0;return(0,n.jsxs)("span",{className:"me-1",style:i?{color:i}:{},children:["[datachannel]",t?"[".concat(t,"]"):"","number"==typeof a?"[".concat(a,"]"):""]})},t3=e=>{let t;let{timestamp:a,logType:i,dataChannelId:s,dataChannelLabel:o,type:l,data:r}=e;return"websocket"===i?t=(0,n.jsx)(t2,{}):"datachannel"===i?t=(0,n.jsx)(t9,{id:s,label:o}):"peerconnection"===i?t=(0,n.jsx)(t5,{}):"sora"===i?t=(0,n.jsx)(t6,{}):"sora-devtools"===i&&(t=(0,n.jsx)(t4,{})),(0,n.jsx)(tj,{title:"".concat(l),timestamp:a,description:r,label:t})},t8=i.memo(e=>(0,n.jsx)(t3,{...e})),t7=()=>{let e=tu(e=>e.timelineMessages),t=tu(e=>e.debugFilterText),a=e.filter(e=>t.split(" ").every(t=>""===t||0<=JSON.stringify(e).indexOf(t)));return(0,n.jsx)("div",{className:"debug-messages",children:a.map(e=>{let t="".concat(e.timestamp,"-").concat(e.type);return e.dataChannelLabel&&(t+="-".concat(e.dataChannelLabel)),(0,n.jsx)(t8,{...e},t)})})},ae=()=>{let e=tu(e=>e.debug),t=tu(e=>e.debugType),a=td();return e?(0,n.jsx)("div",{className:"col-debug col-6",children:(0,n.jsxs)(tm.Z,{id:"debug-tab",activeKey:t,defaultActiveKey:"timeline",onSelect:e=>{("log"===e||"notify"===e||"push"===e||"stats"===e||"timeline"===e||"signaling"===e||"messaging"===e||"codec"===e)&&a(eh(e))},children:[(0,n.jsxs)(tg.Z,{eventKey:"timeline",title:"Timeline",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(t7,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"signaling",title:"Signaling",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(tX,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"notify",title:"Notfiy",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(tH,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"push",title:"Push",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(tL,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"stats",title:"Stats",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(t0,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"log",title:"Log",children:[(0,n.jsx)(tZ,{}),(0,n.jsx)(tV,{})]}),(0,n.jsxs)(tg.Z,{eventKey:"messaging",title:"Messaging",children:[(0,n.jsx)(tG,{}),(0,n.jsx)(tT,{})]}),(0,n.jsx)(tg.Z,{eventKey:"codec",title:"Codec",children:(0,n.jsx)(tS,{})})]})}):null};var at=a(9884),aa=a(6749),an=a(9460);let ai=()=>{let e=td(),t=tu(e=>e.soraContents.reconnectingTrials);return(0,i.useEffect)(()=>{e(H())},[e]),(0,n.jsxs)(an.Z,{delay:2e4,onClose:()=>{e(e2(!1))},children:[(0,n.jsx)(an.Z.Header,{className:"bg-warning text-white",children:(0,n.jsx)("strong",{className:"me-auto",children:"Reconnect"})}),(0,n.jsx)(an.Z.Body,{className:"bg-light",children:(0,n.jsxs)("p",{className:"text-break font-weight-bold mb-0",children:["Reconnecting... (trials ",t,")"]})})]})},as=e=>{let t=td(),a="error"===e.type?"bg-danger":"bg-info";return(0,n.jsxs)(an.Z,{autohide:!0,delay:2e4,onClose:()=>{t(K(e.timestamp))},children:[(0,n.jsxs)(an.Z.Header,{className:"".concat(a," text-white"),children:[(0,n.jsx)("strong",{className:"me-auto",children:e.title}),(0,n.jsx)("span",{children:u(e.timestamp)})]}),(0,n.jsx)(an.Z.Body,{className:"bg-light",children:(0,n.jsx)("p",{className:"text-break font-weight-bold mb-0",children:e.message})})]})},ao=()=>{let e=tu(e=>e.alertMessages),t=tu(e=>e.soraContents.reconnecting);return(0,n.jsxs)("div",{className:"alert-messages",children:[t?(0,n.jsx)(ai,{}):null,e.map(e=>(0,n.jsx)(as,{...e},e.timestamp))]})};var al=a(1449),ar=a(5918);let ac=e=>{let t=d.x$[e.kind];return t?(0,n.jsx)(al.Z,{placement:"top",overlay:(0,n.jsx)(ar.Z,{id:"popover-basic",children:(0,n.jsx)(ar.Z.Body,{style:{whiteSpace:"pre-wrap"},children:t.description})}),children:(0,n.jsx)(tw.Z,{children:e.children})}):(console.warn('Could not load description "'.concat(e.kind,'"')),(0,n.jsx)(tw.Z,{children:e.children}))},ad=e=>(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[e.label?(0,n.jsx)("p",{children:e.label}):null,(0,n.jsxs)("div",{className:"d-flex align-items-center border border-secondary rounded mx-1",children:[(0,n.jsx)("p",{id:e.id,className:"mx-2 p-1",children:e.text}),(0,n.jsx)("div",{className:"border-left border-secondary",children:(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-light",onClick:t=>{m(e.text),t.currentTarget.blur()},children:(0,n.jsx)(tp,{})})})]})]}),au=e=>{let{localVideo:t,connectionId:a,clientId:i}=e;return(0,n.jsxs)(n.Fragment,{children:[a?(0,n.jsx)(ad,{id:t?"local-video-connection-id":void 0,label:"connectionID:",text:a}):null,null!=i&&a!==i?(0,n.jsx)(ad,{id:t?"local-video-client-id":void 0,label:"clientID:",text:i}):null]})},am=e=>{let t=tu(e=>e.soraContents.statsReport),[a,n]=(0,i.useState)([]),[s,o]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{if(void 0===e.getVideoTracks().find(e=>e))return;let a=t.filter(e=>{if("outbound-rtp"===e.type&&"video"===e.kind)return!0});if(0===a.length)return;let i=a.map(e=>{let a=t.find(t=>{if("codec"===t.type)return t.id===e.codecId});return void 0===a?{outboundRtpStats:e}:{codec:a,outboundRtpStats:e}});if(n(i.sort((e,t)=>void 0===e.outboundRtpStats.rid?1:void 0===t.outboundRtpStats.rid?-1:e.outboundRtpStats.rid.localeCompare(t.outboundRtpStats.rid))),null===s){let e=i.filter(e=>void 0!==e.outboundRtpStats.frameWidth).sort((e,t)=>void 0===e.outboundRtpStats.frameWidth?1:void 0===t.outboundRtpStats.frameWidth?-1:t.outboundRtpStats.frameWidth-e.outboundRtpStats.frameWidth);e.length>0&&o(e[0])}else{let e=i.find(e=>e.outboundRtpStats.rid===s.outboundRtpStats.rid);void 0!==e&&o(e)}})()},[t,e,s]),{trackStats:a,selected:s,setSelected:o}},ag=e=>{var t,a,i;let{stream:s}=e,{trackStats:o,selected:l,setSelected:r}=am(s);return(0,n.jsx)("div",{className:"video-overlay",children:0===o.length?(0,n.jsx)("p",{children:"loading..."}):(0,n.jsxs)(n.Fragment,{children:[o.length>1&&(0,n.jsx)("div",{className:"d-flex gap-2",children:o.map(e=>(0,n.jsxs)("div",{className:e.outboundRtpStats.rid===(null==l?void 0:l.outboundRtpStats.rid)?"rid-selected":"rid",onClick:()=>r(e),onKeyDown:()=>r(e),children:["[",e.outboundRtpStats.rid,"]"]},e.outboundRtpStats.rid))}),l&&(0,n.jsxs)("table",{className:"table-video-capabilities",children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"mimeType"}),(0,n.jsx)("td",{children:null===(t=l.codec)||void 0===t?void 0:t.mimeType})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"payloadType"}),(0,n.jsx)("td",{children:null===(a=l.codec)||void 0===a?void 0:a.payloadType})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"sdpFmtpLine"}),(0,n.jsx)("td",{children:null===(i=l.codec)||void 0===i?void 0:i.sdpFmtpLine})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"resolution"}),(0,n.jsxs)("td",{children:[l.outboundRtpStats.frameWidth,"x",l.outboundRtpStats.frameHeight]})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"fps"}),(0,n.jsx)("td",{children:void 0!==l.outboundRtpStats.framesPerSecond?Math.floor(l.outboundRtpStats.framesPerSecond):void 0})]})]})]})})};async function ah(e,t,a,n){let i=window.location.protocol,s="".concat(i,"//").concat(window.location.hostname,":").concat("https:"===i?"443":"3000","/").concat("https:"===i?"api":"");null!==e&&(s=e);let o="Sora_".concat(t,".").concat(a),l=await fetch(s,{method:"POST",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json","x-sora-target":o},mode:"cors"}),r=await l.json();if(!l.ok){let e="POST ".concat(s," ").concat(l.status," (").concat(l.statusText,") target:").concat(o);throw r.error_type&&(e+=" error_type: ".concat(r.error_type)),Error(e)}return r}function ap(e,t,a,n,i){let s={channel_id:t,recv_connection_id:a,rid:n};return i&&(s.send_connection_id=i),ah(e,"20201005","RequestRtpStream",s)}function av(e,t,a,n){let i={channel_id:t,recv_connection_id:a};return n&&(i.send_connection_id=n),ah(e,"20201005","ResetRtpStream",i)}function ax(e,t,a,n,i,s){let o={channel_id:t,recv_connection_id:a,spotlight_focus_rid:n,spotlight_unfocus_rid:i};return s&&(o.send_connection_id=s),ah(e,"20211215","RequestSpotlightRid",o)}function aj(e,t,a,n){let i={channel_id:t,recv_connection_id:a};return n&&(i.send_connection_id=n),ah(e,"20211215","ResetSpotlightRid",i)}let af=e=>{let t=tu(e=>e.soraContents.sora),a=tu(e=>e.apiUrl),i=tu(e=>e.channelId),s=td(),o=async()=>{if(null==t?void 0:t.connectionId)try{let n=await ap(a,i,t.connectionId,e.rid);s(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&s(q(e.message))}};return(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:o})})},aC=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),a=tu(e=>e.soraContents.sora),s=tu(e=>e.channelId),o=tu(e=>e.apiUrl),l=td();if(!(null==a?void 0:a.connectionId))return null;let r=async()=>{if(!(null==a?void 0:a.connectionId)||null===e.current||null===t.current)return;let n=e.current.value,i=t.current.value;try{let e=await ax(o,s,a.connectionId,n,i);l(Q("POST successed. response: ".concat(JSON.stringify(e))))}catch(e){e instanceof Error&&l(q(e.message))}};return(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsxs)(tI.Z,{className:"form-inline",children:[(0,n.jsx)(tJ.Z,{ref:e,children:d.I7.map(e=>""===e?null:(0,n.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e))}),(0,n.jsx)(tJ.Z,{ref:t,children:d.I7.map(e=>""===e?null:(0,n.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e))}),(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRid",defaultValue:"requestSpotlightRid",onClick:r})]})})},ab=()=>{let e=tu(e=>e.soraContents.sora),t=tu(e=>e.channelId),a=tu(e=>e.apiUrl),i=td(),s=async()=>{if(null==e?void 0:e.connectionId)try{let n=await av(a,t,e.connectionId);i(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&i(q(e.message))}};return(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSimulcastRid",defaultValue:"reset rid",onClick:s})})},aS=()=>{let e=tu(e=>e.soraContents.sora),t=tu(e=>e.channelId),a=tu(e=>e.apiUrl),i=td(),s=async()=>{if(null==e?void 0:e.connectionId)try{let n=await aj(a,t,e.connectionId);i(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&i(q(e.message))}};return(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSpotlightRid",defaultValue:"resetSpotlightRid",onClick:s})})},ay=e=>(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)("p",{children:"sessionID:"}),(0,n.jsxs)("div",{className:"d-flex align-items-center border border-secondary rounded mx-1",children:[(0,n.jsx)("p",{id:e.id,className:"mx-2 p-1",children:e.text}),(0,n.jsx)("div",{className:"border-left border-secondary",children:(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-light",onClick:t=>{m(e.text),t.currentTarget.blur()},children:(0,n.jsx)(tp,{})})})]})]}),aN=e=>{let{sessionId:t}=e;return(0,n.jsx)(ay,{id:"session-id",text:t})},ak=e=>{var t;let{displayResolution:a,stream:s,mute:o,audioOutput:l,setHeight:r}=e,c=(0,i.useRef)(null),d=v(a);return(0,i.useEffect)(()=>{let e=new ResizeObserver(e=>{e.filter(e=>{r(e.contentRect.height)})});return c.current&&(l&&s&&s.getAudioTracks().length>0&&c.current.setSinkId(l),e.observe(c.current)),()=>{e.disconnect()}},[r,l,s]),(0,i.useEffect)(()=>{c.current&&o&&(c.current.muted=!0)},[o]),(0,i.useEffect)(()=>{if(c.current&&s){let e;s.getVideoTracks().filter(t=>{e=t.enabled,t.enabled=!1}),c.current.onloadedmetadata=t=>{s.getVideoTracks().filter(t=>{void 0!==e&&(t.enabled=e)})},c.current.srcObject=s,l&&s.getAudioTracks().length>0&&c.current.setSinkId(l)}else c.current&&null===s&&(c.current.srcObject=null)},[s,l]),l&&(null===(t=c.current)||void 0===t?void 0:t.setSinkId)&&s&&s.getAudioTracks().length>0&&c.current.setSinkId(l),(0,n.jsx)("video",{id:e.localVideo?"local-video":void 0,autoPlay:!0,playsInline:!0,controls:!0,muted:o,ref:c,width:0<d.width?d.width:void 0,height:0<d.height?d.height:void 0})},aT=i.memo(e=>(0,n.jsx)(ak,{...e})),aI="#CCCCCC";function aw(e,t,a){e.beginPath(),e.fillStyle=t,e.fillRect(0,a,25,10),e.closePath()}function aR(e,t){let a=Math.ceil(t/12.5),n=t-10;aw(e,aI,n);for(let t=0;t<a;t++)aw(e,aI,n=n-10-2.5)}let aZ=e=>{let t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(0===e.stream.getAudioTracks().length)return;let a=new(window.AudioContext||window.webkitAudioContext),n=a.createMediaStreamSource(e.stream),i=a.createAnalyser();i.fftSize=2048;let s=new Uint8Array(i.frequencyBinCount);n.connect(i);let o=null;return function e(){o=requestAnimationFrame(e),i.getByteTimeDomainData(s);let a=Array.from(s),n=Math.max.apply(null,a)-128,l=t.current;if(null===l)return;let r=l.getContext("2d");null!==r&&(r.clearRect(0,0,25,l.height),r.save(),aR(r,l.height),function(e,t,a){let n=Math.ceil(t*a/12.5);for(let a=0;a<n;a++)aw(e,"#000000",t-10*(a+1)-2.5*a)}(r,l.height,n/128),r.restore())}(),()=>{a&&a.close(),o&&cancelAnimationFrame(o)}},[e.stream]),(0,n.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},aM=e=>{let t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=t.current;if(null===e)return;let a=e.getContext("2d");null!==a&&(a.clearRect(0,0,25,e.height),a.save(),aR(a,e.height),a.restore())},[]),(0,n.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},aP=i.memo(e=>e.micDevice&&0<e.stream.getAudioTracks().length?(0,n.jsx)(aZ,{...e}):(0,n.jsx)(aM,{...e})),aV=()=>{let[e,t]=(0,i.useState)(0),a=tu(e=>e.audio),s=tu(e=>e.video),o=tu(e=>e.audioOutput),l=tu(e=>e.displayResolution),r=tu(e=>e.focusedSpotlightConnectionIds),c=tu(e=>e.soraContents.connectionId),d=tu(e=>e.soraContents.localMediaStream),u=tu(e=>e.micDevice),m=c&&r[c],g=tu(e=>e.mediaStats);return!1===a&&!1===s?null:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"d-flex",children:(0,n.jsxs)("div",{className:"position-relative d-flex flex-nowrap align-items-start video-wrapper overflow-y-hidden".concat(m?" spotlight-focused":""),children:[g&&d&&d.getVideoTracks().length>0&&(0,n.jsx)(ag,{stream:d}),(0,n.jsx)(aT,{stream:d,setHeight:t,audioOutput:o,displayResolution:l,localVideo:!0,mute:!0}),null!==d?(0,n.jsx)(aP,{micDevice:u,stream:d,height:e}):null]})})})},aD=()=>{let e=tu(e=>e.soraContents.connectionId),t=tu(e=>e.soraContents.clientId),a=tu(e=>e.soraContents.sessionId),i=tu(e=>e.simulcast),s=tu(e=>e.spotlight),o=tu(e=>e.role),l=tu(e=>e.soraContents.localMediaStream);return(0,n.jsx)("div",{className:"row my-1",children:(0,n.jsxs)("div",{className:"col-auto",children:[(0,n.jsxs)("div",{className:"video-status mb-1",children:[null!==a?(0,n.jsx)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:(0,n.jsx)(aN,{sessionId:a})}):null,null!==e||null!==t?(0,n.jsx)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:(0,n.jsx)(au,{connectionId:e,clientId:t,localVideo:!0})}):null,null!==e&&"true"!==s&&"true"===i&&"sendonly"!==o?(0,n.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,n.jsx)(ac,{kind:"changeAllRecvStream",children:"change all:"}),(0,n.jsx)(af,{rid:"r0"}),(0,n.jsx)(af,{rid:"r1"}),(0,n.jsx)(af,{rid:"r2"}),(0,n.jsx)(ab,{})]}):null,null!==e&&"true"===s?(0,n.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,n.jsx)(aC,{}),(0,n.jsx)(aS,{})]}):null]}),null!==l&&"recvonly"!==o?(0,n.jsx)(aV,{}):null]})})};function aA(e,t,a){if(null===t)return;let n=[];return"video"===a?n=t.getVideoTracks().map(e=>e.id):"audio"===a&&(n=t.getAudioTracks().map(e=>e.id)),e.find(e=>"inbound-rtp"===e.type&&"kind"in e&&"trackIdentifier"in e&&!!(e.kind===a&&n.includes(e.trackIdentifier)))}let aF=e=>{let t=tu(e=>e.soraContents.statsReport),a=tu(e=>e.soraContents.prevStatsReport),i=aA(t,e.stream,e.type),s=aA(a,e.stream,e.type);if(void 0===i||void 0===i.jitterBufferDelay||void 0===i.jitterBufferEmittedCount)return null;let o=i.jitterBufferDelay,l=i.jitterBufferEmittedCount;void 0!==s&&void 0!==s.jitterBufferDelay&&void 0!==s.jitterBufferEmittedCount&&(o=i.jitterBufferDelay-s.jitterBufferDelay,l=i.jitterBufferEmittedCount-s.jitterBufferEmittedCount);let r=Math.floor(o/l*1e3),c="normal-jitter-buffer";return 500<r?c="critical-jitter-buffer":300<r?c="danger-jitter-buffer":100<r&&(c="warning-jitter-buffer"),(0,n.jsx)("div",{className:"btn btn-sm mx-1 ".concat(c),children:(0,n.jsxs)("span",{children:[e.type,": ",r]})})},aO=e=>{let t=tu(e=>e.soraContents.statsReport),a=tu(e=>e.soraContents),[n,s]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{var n;let i,o;if(!(null===(n=a.sora)||void 0===n?void 0:n.pc))return;let l=e.getVideoTracks().find(e=>e);if(void 0===l)return;let r=await a.sora.pc.getReceivers().find(e=>e.track.id===l.id);if(void 0!==r){for(let e of(await r.getStats())){let[t,a]=e;if(a.codecId){i=a.codecId;break}}if(void 0!==i){for(let e of t)"codec"===e.type&&i===e.id&&(o=e);o&&s({codec:o,videoTrackStats:{width:l.getSettings().width,height:l.getSettings().height,frameRate:void 0!==l.getSettings().frameRate?Math.floor(l.getSettings().frameRate||0):void 0}})}}})()},[t,e,a]),{trackStats:n}},aH=e=>{let{stream:t}=e,{trackStats:a}=aO(t);return(0,n.jsx)("div",{className:"video-overlay",children:null===a?(0,n.jsx)("p",{children:"loading..."}):(0,n.jsxs)("table",{className:"table-video-capabilities",children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"mimeType"}),(0,n.jsx)("td",{children:a.codec.mimeType})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"payloadType"}),(0,n.jsx)("td",{children:a.codec.payloadType})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"sdpFmtpLine"}),(0,n.jsx)("td",{children:a.codec.sdpFmtpLine})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"resolution"}),(0,n.jsx)("td",{children:void 0===a.videoTrackStats.width||void 0===a.videoTrackStats.height?"undefined":"".concat(a.videoTrackStats.width,"x").concat(a.videoTrackStats.height)})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"fps"}),(0,n.jsx)("td",{children:void 0===a.videoTrackStats.frameRate?"undefined":a.videoTrackStats.frameRate})]})]})})},aU=e=>{let t=tu(e=>e.soraContents.sora),a=tu(e=>e.apiUrl),i=tu(e=>e.channelId),s=td(),o=async()=>{if(null==t?void 0:t.connectionId)try{let n=await ap(a,i,t.connectionId,e.rid,e.sendConnectionId);s(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&s(q(e.message))}};return(0,n.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:o})},aB=e=>{let t=(0,i.useRef)(null),a=(0,i.useRef)(null),s=tu(e=>e.soraContents.sora),o=tu(e=>e.channelId),l=tu(e=>e.apiUrl),r=td();if(!(null==s?void 0:s.connectionId))return null;let c=async()=>{if(!(null==s?void 0:s.connectionId)||null===t.current||null===a.current)return;let n=t.current.value,i=a.current.value;try{let t=await ax(l,o,s.connectionId,n,i,e.sendConnectionId);r(Q("POST successed. response: ".concat(JSON.stringify(t))))}catch(e){e instanceof Error&&r(q(e.message))}};return(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsxs)(tI.Z,{className:"form-inline",children:[(0,n.jsx)(tJ.Z,{ref:t,children:d.I7.map(e=>""===e?null:(0,n.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e))}),(0,n.jsx)(tJ.Z,{ref:a,children:d.I7.map(e=>""===e?null:(0,n.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e))}),(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRidBySendConnectionId",defaultValue:"requestSpotlightRid",onClick:c})]})})},aE=e=>{let t=tu(e=>e.soraContents.sora),a=tu(e=>e.channelId),i=tu(e=>e.apiUrl),s=td(),o=async()=>{if(null==t?void 0:t.connectionId)try{let n=await av(i,a,t.connectionId,e.sendConnectionId);s(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&s(q(e.message))}};return(0,n.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"resetRtpStream",defaultValue:"reset rid",onClick:o})},a_=e=>{let t=tu(e=>e.soraContents.sora),a=tu(e=>e.channelId),i=tu(e=>e.apiUrl),s=td(),o=async()=>{if(null==t?void 0:t.connectionId)try{let n=await aj(i,a,t.connectionId,e.sendConnectionId);s(Q("POST successed. response: ".concat(JSON.stringify(n))))}catch(e){e instanceof Error&&s(q(e.message))}};return(0,n.jsx)("input",{className:"btn btn-secondary mx-1",type:"button",name:"resetSpotlightRid",defaultValue:"resetSpotlightRid",onClick:o})};function aL(e,t){if(null===t)return[];let a=t.getTracks().map(e=>e.id),n=[];for(let t of e)(!t.id||t.id.match(/^RTCMediaStreamTrack/))&&"trackIdentifier"in t&&t.trackIdentifier&&a.includes(t.trackIdentifier)&&n.push(t);return n}let aJ=e=>{let t=tu(e=>e.showStats),a=tu(e=>e.soraContents.statsReport),i=tu(e=>e.soraContents.prevStatsReport);if(!t)return null;let s=aL(a,e.stream),o=aL(i,e.stream);return(0,n.jsx)(n.Fragment,{children:s.map(e=>{let t=0,a=0,i=o.find(t=>e.id===t.id);return i&&(t=e.jitterBufferDelay-i.jitterBufferDelay,a=e.jitterBufferEmittedCount-i.jitterBufferEmittedCount),(0,n.jsx)("div",{children:(0,n.jsxs)("ul",{className:"mediastream-stats-report",children:[Object.entries(e).map(e=>{let[t,a]=e;return(0,n.jsxs)("li",{children:[(0,n.jsxs)("strong",{children:[t,":"]})," ",a]},t)}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"[jitterBufferDelay/jitterBufferEmittedCount_in_ms]"})," ",Math.floor(t/a*1e3)]})]})},e.id)})})},az=e=>{let{client:t}=e,{mediaStream:a,connectionId:s,clientId:o}=t,[l,r]=(0,i.useState)(0),c=tu(e=>e.audioOutput),d=tu(e=>e.displayResolution),u=tu(e=>e.focusedSpotlightConnectionIds),m=tu(e=>e.multistream),g=tu(e=>e.mute),h=tu(e=>e.simulcast),p=tu(e=>e.spotlight),v=s&&u[s],x=tu(e=>e.mediaStats);return(0,n.jsxs)("div",{className:"col-auto",children:[(0,n.jsxs)("div",{className:"video-status",children:[(0,n.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,n.jsx)(au,{connectionId:s,clientId:o}),(0,n.jsx)(aF,{type:"audio",stream:a}),(0,n.jsx)(aF,{type:"video",stream:a})]}),(0,n.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:["true"!==p&&"true"===m&&"true"===h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aU,{rid:"r0",sendConnectionId:s}),(0,n.jsx)(aU,{rid:"r1",sendConnectionId:s}),(0,n.jsx)(aU,{rid:"r2",sendConnectionId:s}),(0,n.jsx)(aE,{sendConnectionId:s})]}):null,"true"===p&&"true"===m&&"true"===h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aB,{sendConnectionId:s}),(0,n.jsx)(a_,{sendConnectionId:s})]}):null]})]}),(0,n.jsxs)("div",{className:"d-flex flex-wrap align-items-start overflow-y-hidden",children:[(0,n.jsxs)("div",{className:"position-relative d-flex flex-nowrap align-items-start video-wrapper".concat(v?" spotlight-focused":""),children:[x&&a.getVideoTracks().length>0&&(0,n.jsx)(aH,{stream:a}),(0,n.jsx)(aT,{stream:a,setHeight:r,mute:g,audioOutput:c,displayResolution:d}),(0,n.jsx)(aP,{micDevice:!0,stream:a,height:l})]}),(0,n.jsx)(aJ,{stream:a})]})]})},aG=()=>{let e=tu(e=>e.soraContents.remoteClients);return(0,n.jsx)("div",{className:"row my-2",children:e.map(e=>(0,n.jsx)(az,{client:e},e.connectionId))})},aW=()=>{let e=tu(e=>e.aspectRatio),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"aspectRatio",children:[(0,n.jsx)(ac,{kind:"aspectRatio",children:"aspectRatio:"}),(0,n.jsx)(tJ.Z,{name:"aspectRatio",value:e,onChange:e=>{g(e.target.value,d.Ii)&&t(X(e.target.value))},children:d.Ii.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},aK=()=>{let e=tu(e=>e.audioBitRate),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"audioBitRate",children:[(0,n.jsx)(ac,{kind:"audioBitRate",children:"audioBitRate:"}),(0,n.jsx)(tJ.Z,{name:"audioBitRate",value:e,onChange:e=>{g(e.target.value,d.xR)&&a(Y(e.target.value))},disabled:t,children:d.xR.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},aq=()=>{let e=tu(e=>e.audioCodecType),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"audioCodecType",children:[(0,n.jsx)(ac,{kind:"audioCodecType",children:"audioCodecType:"}),(0,n.jsx)(tJ.Z,{name:"audioCodecType",value:e,onChange:e=>{g(e.target.value,d.o1)&&a(ee(e.target.value))},disabled:t,children:d.o1.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},aQ=()=>{let e=tu(e=>e.audioContentHint),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"audioContentHint",children:[(0,n.jsx)(ac,{kind:"audioContentHint",children:"audioContentHint:"}),(0,n.jsx)(tJ.Z,{name:"audioContentHint",value:e,onChange:e=>{g(e.target.value,d.nT)&&t(et(e.target.value))},children:d.nT.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})};var aX=a(66);let a$=e=>{let{children:t,kind:a,checked:i,onChange:s,disabled:o}=e,l=d.x$[a];return l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aX.Z,{type:"switch",checked:i,onChange:s,disabled:o}),(0,n.jsx)(al.Z,{placement:"top",overlay:(0,n.jsx)(ar.Z,{id:"popover-basic",children:(0,n.jsx)(ar.Z.Body,{style:{whiteSpace:"pre-wrap"},children:l.description})}),children:(0,n.jsx)(tw.Z,{children:t})})]}):(console.warn('Could not load description "'.concat(a,'"')),(0,n.jsx)(tw.Z,{children:t}))},aY=()=>{let e=tu(e=>e.audio),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"audio",children:(0,n.jsx)(a$,{kind:"audio",checked:e,onChange:e=>{a($(e.target.checked))},disabled:t,children:"audio"})})},a0=()=>{let e=tu(e=>e.audioInput),t=tu(e=>e.audioInputDevices),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"audioInput",children:[(0,n.jsx)(ac,{kind:"audioInput",children:"audioInput:"}),(0,n.jsxs)(tJ.Z,{name:"audioInput",value:e,onChange:e=>{a(ea(e.target.value)),a(E())},disabled:0===t.length,children:[(0,n.jsx)("option",{value:"",children:""}),t.map(e=>(0,n.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId))]})]})},a1=()=>{let e=tu(e=>e.audioOutput),t=tu(e=>e.audioOutputDevices),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"audioOutput",children:[(0,n.jsx)(ac,{kind:"audioOutput",children:"audioOutput:"}),(0,n.jsxs)(tJ.Z,{name:"audioOutput",value:e,onChange:e=>{a(en(e.target.value))},disabled:0===t.length,children:[(0,n.jsx)("option",{value:"",children:""}),t.map(e=>(0,n.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId))]})]})},a2=()=>{let e=tu(e=>e.enabledAudioStreamingLanguageCode),t=tu(e=>e.audioStreamingLanguageCode),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledAudioStreamingLanguageCode",children:(0,n.jsx)(a$,{kind:"audioStreamingLanguageCode",checked:e,onChange:e=>{i(eM(e.target.checked))},disabled:a,children:"audioStreamingLanguageCode"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"audioStreamingLanguageCode",children:(0,n.jsx)(tR.Z,{className:"flex-fill w-500",type:"text",placeholder:"audioStreamingLanguageCode",value:t,onChange:e=>{i(eZ(e.target.value))},disabled:a})})})}):null]})},a5=()=>{let e=tu(e=>e.audioTrack),t=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"audioTrack",children:(0,n.jsx)(a$,{kind:"audioTrack",checked:e,onChange:e=>{t(ei(e.target.checked))},disabled:!1,children:"Enable audio track"})})},a6=()=>{let e=tu(e=>e.autoGainControl),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"autoGainControl",children:[(0,n.jsx)(ac,{kind:"autoGainControl",children:"autoGainControl:"}),(0,n.jsx)(tJ.Z,{name:"autoGainControl",value:e,onChange:e=>{g(e.target.value,d.iN)&&t(es(e.target.value))},children:d.iN.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},a4=()=>{let e=tu(e=>e.blurRadius),t=tu(e=>e.mediaType),a=td(),i="getUserMedia"!==t;return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"blurRadius",children:[(0,n.jsx)(ac,{kind:"blurRadius",children:"blurRadius:"}),(0,n.jsx)(tJ.Z,{value:e,onChange:e=>{g(e.target.value,d.G_)&&a(eo(e.target.value))},disabled:i,children:d.G_.map(e=>(0,n.jsx)("option",{suppressHydrationWarning:!0,value:e,children:""===e||i?"":e},e))})]})},a9=()=>{let e=tu(e=>e.enabledBundleId),t=tu(e=>e.bundleId),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledBundleId",children:(0,n.jsx)(a$,{kind:"bundleId",checked:e,onChange:e=>{i(ej(e.target.checked))},disabled:a,children:"bundleId"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"bundleId",children:(0,n.jsx)(tR.Z,{className:"flex-fill w-500",type:"text",placeholder:"bundleId",value:t,onChange:e=>{i(el(e.target.value))},disabled:a})})})}):null]})},a3=()=>{let e=tu(e=>e.cameraDevice),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.soraContents.sora),i=tu(e=>e.video),s=!(a&&"connected"===t?a.video:i),o=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"cameraDevice",children:(0,n.jsx)(a$,{kind:"cameraDevice",checked:e,onChange:e=>{o(L(e.target.checked))},disabled:s,children:"Enable camera device"})})},a8=()=>{let e=tu(e=>e.channelId),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"channelId",children:[(0,n.jsx)(ac,{kind:"channelId",children:"channelId:"}),(0,n.jsx)(tR.Z,{type:"text",placeholder:"ChannelId",value:e,onChange:e=>{a(er(e.target.value))},disabled:t})]})},a7=()=>{let e=tu(e=>e.enabledClientId),t=tu(e=>e.clientId),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledClientId",children:(0,n.jsx)(a$,{kind:"clientId",checked:e,onChange:e=>{i(ef(e.target.checked))},disabled:a,children:"clientId"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"clientId",children:(0,n.jsx)(tR.Z,{className:"flex-fill w-500",type:"text",placeholder:"ClientId",value:t,onChange:e=>{i(ec(e.target.value))},disabled:a})})})}):null]})},ne=()=>{let e=tu(e=>e.soraContents.connectionStatus),t=td();return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"connect",defaultValue:"connect",onClick:()=>{t(O())},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})},nt=e=>{let t=tu(e=>e.ignoreDisconnectWebSocket),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"ignoreDisconnectWebSocket",children:[(0,n.jsx)(ac,{kind:"ignoreDisconnectWebSocket",children:"ignoreDisconnectWebSocket:"}),(0,n.jsx)(tJ.Z,{name:"ignoreDisconnectWebSocket",value:t,onChange:e=>{g(e.target.value,d.kt)&&a(eA(e.target.value))},disabled:e.disabled,children:d.kt.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},na=e=>{let t=tu(e=>e.dataChannelSignaling),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"dataChannelSignaling",children:[(0,n.jsx)(ac,{kind:"dataChannelSignaling",children:"dataChannelSignaling:"}),(0,n.jsx)(tJ.Z,{name:"dataChannelSignaling",value:t,onChange:e=>{g(e.target.value,d.l9)&&a(eu(e.target.value))},disabled:e.disabled,children:d.l9.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nn=()=>{let e=tu(e=>e.enabledDataChannel),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledDataChannel",children:(0,n.jsx)(aX.Z,{type:"switch",name:"enabledDataChannel",label:"dataChannel",checked:e,onChange:e=>{a(eb(e.target.checked))},disabled:t})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsxs)(at.Z,{xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(na,{disabled:t})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nt,{disabled:t})})]})})}):null]})},ni=()=>{let e=tu(e=>e.enabledDataChannels),t=tu(e=>e.dataChannels),a=y(tu(e=>e.soraContents.connectionStatus)),i=td(),s=JSON.stringify([{label:"#devtools",maxPacketLifeTime:10,ordered:!0,compress:!1,direction:"sendrecv"}],null,2);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledDataChannels",children:(0,n.jsx)(a$,{kind:"dataChannels",checked:e,onChange:e=>{i(eC(e.target.checked))},disabled:a,children:"dataChannels"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsxs)(tI.Z,{className:"form-inline position-relative",controlId:"dataChannels",children:[(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"dataChannels\n()\n".concat(s),value:t,onChange:e=>{i(ed(e.target.value))},rows:12,cols:100,disabled:a}),(0,n.jsx)(tz.Z,{className:"btn-load-template",type:"button",variant:"outline-secondary",size:"sm",onClick:()=>i(ed(s)),children:"load template"})]})})}):null]})},ns=()=>{let e=tu(e=>e.soraContents.connectionStatus),t=td();return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"disconnect",defaultValue:"disconnect",onClick:()=>{t(U())},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})};var no=a(6152),nl=a(8356),nr=a(3989),nc=a(3629);let nd=[{label:"",value:""},{label:"144p",value:"256x144"},{label:"240p",value:"320x240"},{label:"360p",value:"640x360"},{label:"480p",value:"720x480"},{label:"540p",value:"960x540"},{label:"720p",value:"1280x720"},{label:"1080p",value:"1920x1080"},{label:"1440p",value:"2560x1440"},{label:"2160p",value:"3840x2160"}],nu=e=>{let{label:t,value:a}=e,i=td();return(0,n.jsxs)(no.Z.Item,{as:"button",onClick:()=>i(ep(a)),children:[t," ",""!==a&&"(".concat(a,")")]})},nm=()=>{let e=tu(e=>e.displayResolution),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"displayResolution",children:[(0,n.jsx)(ac,{kind:"displayResolution",children:"displayResolution:"}),(0,n.jsxs)(nl.Z,{children:[(0,n.jsx)(nr.Z.Control,{className:"form-display-resolution",type:"text",value:e,onChange:e=>{t(ep(e.target.value))},placeholder:""}),(0,n.jsx)(nc.Z,{variant:"outline-secondary form-template-dropdown",title:"",align:"end",children:nd.map(e=>{let{label:t,value:a}=e;return(0,n.jsx)(nu,{label:t,value:a},a)})})]})]})},ng=()=>{let e=td(),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.soraContents.sora),i="recvonly"===tu(e=>e.role)||null!==a||y(t);return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"media_access",defaultValue:"dispose media",onClick:()=>{e(F())},disabled:i})})},nh=()=>{let e=tu(e=>e.echoCancellation),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"echoCancellation",children:[(0,n.jsx)(ac,{kind:"echoCancellation",children:"echoCancellation:"}),(0,n.jsx)(tJ.Z,{name:"echoCancellation",value:e,onChange:e=>{g(e.target.value,d.PS)&&t(ev(e.target.value))},children:d.PS.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},np=()=>{let e=tu(e=>e.echoCancellationType),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"echoCancellationType",children:[(0,n.jsx)(ac,{kind:"echoCancellationType",children:"echoCancellationType:"}),(0,n.jsx)(tJ.Z,{name:"echoCancellationType",value:e,onChange:e=>{g(e.target.value,d.cJ)&&t(ex(e.target.value))},children:d.cJ.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nv=()=>{let e=tu(e=>e.facingMode),t=tu(e=>e.mediaType),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"facingMode",children:[(0,n.jsx)(ac,{kind:"facingMode",children:"facingMode:"}),(0,n.jsx)(tJ.Z,{name:"facingMode",value:e,onChange:e=>{g(e.target.value,d.pT)&&a(eV(e.target.value))},disabled:"getUserMedia"!==t,children:d.pT.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nx=()=>{let e=tu(e=>e.mediaType),t=tu(e=>e.fakeVolume),a=td();return"fakeMedia"!==e?null:(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"fakeVolume",children:[(0,n.jsx)(ac,{kind:"fakeVolume",children:"fakeVolume:"}),(0,n.jsx)(nr.Z.Range,{min:"0",max:"1",step:"0.25",value:t,onChange:e=>{a(eP(e.target.value))}})]})},nj=()=>{let e=tu(e=>e.enabledForwardingFilter),t=tu(e=>e.forwardingFilter),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledForwardingFilter",children:(0,n.jsx)(a$,{kind:"forwardingFilter",checked:e,onChange:e=>{i(eS(e.target.checked))},disabled:a,children:"forwardingFilter"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"forwardingFilter",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"forwardingFilter",value:t,onChange:e=>{i(e$(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},nf=[{label:"",value:""},{label:"60",value:"60"},{label:"30",value:"30"},{label:"24",value:"24"},{label:"20",value:"20"},{label:"15",value:"15"},{label:"10",value:"10"},{label:"5",value:"5"}],nC=e=>{let{label:t,value:a}=e,i=td();return(0,n.jsx)(no.Z.Item,{as:"button",onClick:()=>i(eD(a)),children:t})},nb=()=>{let e=tu(e=>e.frameRate),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"frameRate",children:[(0,n.jsx)(ac,{kind:"frameRate",children:"frameRate:"}),(0,n.jsxs)(nl.Z,{children:[(0,n.jsx)(nr.Z.Control,{className:"form-frame-rate",type:"text",value:e,onChange:e=>{t(eD(e.target.value))},placeholder:""}),(0,n.jsx)(nc.Z,{variant:"outline-secondary form-template-dropdown",title:"",align:"end",children:nf.map(e=>{let{label:t,value:a}=e;return(0,n.jsx)(nC,{label:t,value:a},a)})})]})]})},nS=()=>{let e=tu(e=>e.lightAdjustment),t=tu(e=>e.mediaType),a=td(),i="getUserMedia"!==t;return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"lightAdjustment",children:[(0,n.jsx)(ac,{kind:"lightAdjustment",children:"lightAdjustment:"}),(0,n.jsx)(tJ.Z,{value:e,onChange:e=>{g(e.target.value,d.Xv)&&a(eF(e.target.value))},disabled:i,children:d.Xv.map(e=>(0,n.jsx)("option",{suppressHydrationWarning:!0,value:e,children:""===e||i?"":e},e))})]})},ny=()=>{let e=tu(e=>e.mediaProcessorsNoiseSuppression),t=tu(e=>e.mediaType),a=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"mediaProcessorsNoiseSuppression",children:(0,n.jsx)(a$,{kind:"mediaProcessorsNoiseSuppression",checked:e,onChange:e=>{a(eU(e.target.checked))},disabled:"getUserMedia"!==t,children:"mediaProcessorsNoiseSuppression"})})},nN=()=>{let e=tu(e=>e.mediaStats),t=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"mediaStats",children:(0,n.jsx)(a$,{kind:"mediaStats",checked:e,onChange:e=>{t(eB(e.target.checked))},disabled:!1,children:"Show media stats"})})},nk=e=>{let{label:t,disabled:a,onChange:i,mediaType:s}=e;return(0,n.jsx)(aX.Z,{type:"radio",inline:!0,id:t,label:t,value:t,checked:s===t,onChange:i,disabled:a})},nT=()=>{let[e,t]=(0,i.useState)(!1),a=void 0!==window.CropTarget,s=tu(e=>e.soraContents.connectionStatus),o=tu(e=>e.soraContents.localMediaStream),l=tu(e=>e.mediaType),r=null!==o||y(s),c=td(),u=e=>{g(e.target.value,d.w_)&&c(eE(e.target.value))};return(0,i.useEffect)(()=>{t(!0)},[]),(0,n.jsxs)(tI.Z,{className:"form-inline flex-wrap",children:[(0,n.jsx)(ac,{kind:"mediaType",children:"mediaType:"}),(0,n.jsx)(nk,{label:"getUserMedia",mediaType:l,disabled:r,onChange:u}),(0,n.jsx)(nk,{label:"getDisplayMedia",mediaType:l,disabled:r,onChange:u}),(0,n.jsx)(nk,{label:"fakeMedia",mediaType:l,disabled:r,onChange:u}),e&&(0,n.jsx)(nk,{label:"mediacaptureRegion",mediaType:l,disabled:r||!a,onChange:u})]})},nI=()=>{let e=tu(e=>e.enabledMetadata),t=tu(e=>e.metadata),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledMetadata",children:(0,n.jsx)(a$,{kind:"metadata",checked:e,onChange:e=>{i(ey(e.target.checked))},disabled:a,children:"metadata"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"metadata",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"Metadata",value:t,onChange:e=>{i(e_(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},nw=()=>{let e=tu(e=>e.micDevice),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.soraContents.sora),i=tu(e=>e.audio),s=!(a&&"connected"===t?a.audio:i),o=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"micDevice",children:(0,n.jsx)(a$,{kind:"micDevice",checked:e,onChange:e=>{o(_(e.target.checked))},disabled:s,children:"Enable mic device"})})},nR=()=>{let e=tu(e=>e.multistream),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"multistream",children:[(0,n.jsx)(ac,{kind:"multistream",children:"multistream:"}),(0,n.jsx)(tJ.Z,{name:"multistream",value:e,onChange:e=>{g(e.target.value,d.u9)&&a(eL(e.target.value))},disabled:t,children:d.u9.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nZ=()=>{let e=tu(e=>e.noiseSuppression),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"noiseSuppression",children:[(0,n.jsx)(ac,{kind:"noiseSuppression",children:"noiseSuppression:"}),(0,n.jsx)(tJ.Z,{name:"noiseSuppression",value:e,onChange:e=>{g(e.target.value,d.ad)&&t(eJ(e.target.value))},children:d.ad.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nM=()=>{let e=tu(e=>e.reconnect),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"reconnect",children:(0,n.jsx)(a$,{kind:"reconnect",checked:e,onChange:e=>{a(eG(e.target.checked))},disabled:t,children:"reconnect"})})})})},nP=()=>{let e=td();return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-devices",defaultValue:"update-devices",onClick:()=>{e(B())}})})},nV=()=>{let e=td(),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.soraContents.sora),i="recvonly"===tu(e=>e.role)||null!==a||y(t);return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"media_access",defaultValue:"request media",onClick:()=>{e(A())},disabled:i})})},nD=()=>{let e=tu(e=>e.resizeMode),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"resizeMode",children:[(0,n.jsx)(ac,{kind:"resizeMode",children:"resizeMode:"}),(0,n.jsx)(tJ.Z,{name:"resizeMode",value:e,onChange:e=>{g(e.target.value,d.L4)&&t(eW(e.target.value))},children:d.L4.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nA=[{label:"",value:""},{label:"144p",value:"256x144"},{label:"240p",value:"320x240"},{label:"360p",value:"640x360"},{label:"480p",value:"720x480"},{label:"540p",value:"960x540"},{label:"720p",value:"1280x720"},{label:"1080p",value:"1920x1080"},{label:"1440p",value:"2560x1440"},{label:"2160p",value:"3840x2160"}],nF=e=>{let{label:t,value:a}=e,i=td();return(0,n.jsxs)(no.Z.Item,{as:"button",onClick:()=>i(eq(a)),children:[t," ",""!==a&&"(".concat(a,")")]})},nO=()=>{let e=tu(e=>e.resolution),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"resolution",children:[(0,n.jsx)(ac,{kind:"resolution",children:"resolution:"}),(0,n.jsxs)(nl.Z,{children:[(0,n.jsx)(nr.Z.Control,{className:"form-resolution",type:"text",value:e,onChange:e=>{t(eq(e.target.value))},placeholder:""}),(0,n.jsx)(nc.Z,{variant:"outline-secondary form-template-dropdown",title:"",align:"end",children:nA.map(e=>{let{label:t,value:a}=e;return(0,n.jsx)(nF,{label:t,value:a},a)})})]})]})},nH=()=>{let e=tu(e=>e.role),t=tu(e=>e.soraContents.connectionStatus),a=null!==tu(e=>e.soraContents.localMediaStream)||y(t),i=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"role",children:[(0,n.jsx)(ac,{kind:"role",children:"role:"}),(0,n.jsx)(tJ.Z,{name:"role",value:e,onChange:e=>{g(e.target.value,d.K$)&&i(eK(e.target.value))},disabled:a,children:d.K$.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]})},nU=()=>{let e=tu(e=>e.enabledSignalingNotifyMetadata),t=tu(e=>e.signalingNotifyMetadata),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledSignalingNotifyMetadata",children:(0,n.jsx)(a$,{kind:"signalingNotifyMetadata",checked:e,onChange:e=>{i(eN(e.target.checked))},disabled:a,children:"signalingNotifyMetadata"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingNotifyMetadata",value:t,onChange:e=>{i(eQ(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},nB=()=>{let e=tu(e=>e.enabledSignalingUrlCandidates),t=tu(e=>e.signalingUrlCandidates),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",xs:"auto",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledSignalingUrlCandidates",children:(0,n.jsx)(a$,{kind:"signalingUrlCandidates",checked:e,onChange:e=>{i(ek(e.target.checked))},disabled:a,children:"signalingUrlCandidates"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",xs:"auto",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingUrlCandidates\n()\nwss://sora0.example.com/signaling\nwss://sora1.example.com/signaling\n",value:t.join("\n"),onChange:e=>{i(eX(e.target.value.split("\n")))},rows:5,cols:100,disabled:a})})})}):null]})},nE=()=>{let e=tu(e=>e.simulcast),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"simulcast",children:[(0,n.jsx)(ac,{kind:"simulcast",children:"simulcast:"}),(0,n.jsx)(tJ.Z,{name:"simulcast",value:e,onChange:e=>{g(e.target.value,d.VE)&&a(eY(e.target.value))},disabled:t,children:d.VE.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},n_=()=>{let e=tu(e=>e.simulcastRid),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"simulcastRid",children:[(0,n.jsx)(ac,{kind:"simulcastRid",children:"simulcastRid:"}),(0,n.jsx)(tJ.Z,{name:"simulcastRid",value:e,onChange:e=>{g(e.target.value,d.WJ)&&a(e0(e.target.value))},disabled:t,children:d.WJ.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nL=()=>{let e=tu(e=>e.spotlightFocusRid),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"spotlightFocusRid",children:[(0,n.jsx)(ac,{kind:"spotlightFocusRid",children:"spotlightFocusRid:"}),(0,n.jsx)(tJ.Z,{value:e,onChange:e=>{g(e.target.value,d.I7)&&a(e9(e.target.value))},disabled:t,children:d.I7.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nJ=()=>{let e=tu(e=>e.spotlight),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"spotlight",children:[(0,n.jsx)(ac,{kind:"spotlight",children:"spotlight:"}),(0,n.jsx)(tJ.Z,{name:"spotlight",value:e,onChange:e=>{g(e.target.value,d.VJ)&&a(e4(e.target.value))},disabled:t,children:d.VJ.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nz=()=>{let e=tu(e=>e.spotlightNumber),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"spotlightNumber",children:[(0,n.jsx)(ac,{kind:"spotlightNumber",children:"spotlightNumber:"}),(0,n.jsx)(tJ.Z,{value:e,onChange:e=>{g(e.target.value,d.Xr)&&a(e3(e.target.value))},disabled:t,children:d.Xr.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nG=()=>{let e=tu(e=>e.spotlightUnfocusRid),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"spotlightUnfocusRid",children:[(0,n.jsx)(ac,{kind:"spotlightUnfocusRid",children:"spotlightUnfocusRid:"}),(0,n.jsx)(tJ.Z,{value:e,onChange:e=>{g(e.target.value,d.I7)&&a(e8(e.target.value))},disabled:t,children:d.I7.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},nW=()=>{let e=tu(e=>e.channelId),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.apiUrl),i=td(),s=async()=>{try{let t=await ah(a,"20231220","StartRecording",{channel_id:e,expire_time:3600});i(Q("POST successed. response: ".concat(JSON.stringify(t))))}catch(e){e instanceof Error&&i(q(e.message))}};return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"startRec",defaultValue:"start rec",onClick:s,disabled:"initializing"===t})})},nK=()=>{let e=tu(e=>e.channelId),t=tu(e=>e.soraContents.connectionStatus),a=tu(e=>e.apiUrl),i=td(),s=async()=>{try{let t=await ah(a,"20231220","StopRecording",{channel_id:e});i(Q("POST successed. response: ".concat(JSON.stringify(t))))}catch(e){e instanceof Error&&i(q(e.message))}};return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-secondary",type:"button",name:"stopRec",defaultValue:"stop rec",onClick:s,disabled:"initializing"===t})})},nq=()=>{let e=td();return(0,n.jsx)("div",{className:"col-auto mb-1",children:(0,n.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-mediastream",defaultValue:"update-mediastream",onClick:()=>{e(E())}})})},nQ=()=>{let e=tu(e=>e.enabledVideoAV1Params),t=tu(e=>e.videoAV1Params),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledVideoAV1Params",children:(0,n.jsx)(a$,{kind:"videoAV1Params",checked:e,onChange:e=>{i(eR(e.target.checked))},disabled:a,children:"videoAV1Params"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"videoAV1Params",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"videoAV1Params",value:t,onChange:e=>{i(tr(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},nX=d.Q5.slice();nX.splice(d.Q5.indexOf("15000")+1,0,"support-message");let n$=()=>{let e=tu(e=>e.videoBitRate),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"videoBitRate",children:[(0,n.jsx)(ac,{kind:"videoBitRate",children:"videoBitRate:"}),(0,n.jsx)(tJ.Z,{name:"videoBitRate",value:e,onChange:e=>{g(e.target.value,d.Q5)&&a(te(e.target.value))},disabled:t,children:nX.map(e=>{let t=e;return""===e?t="":"support-message"===e&&(t=""),(0,n.jsx)("option",{value:e,disabled:"support-message"===e,children:t},e)})})]})},nY=()=>{let e=tu(e=>e.videoCodecType),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"videoCodecType",children:[(0,n.jsx)(ac,{kind:"videoCodecType",children:"videoCodecType:"}),(0,n.jsx)(tJ.Z,{name:"videoCodecType",value:e,onChange:e=>{g(e.target.value,d.Sh)&&a(tt(e.target.value))},disabled:t,children:d.Sh.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},n0=()=>{let e=tu(e=>e.videoContentHint),t=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"videoContentHint",children:[(0,n.jsx)(ac,{kind:"videoContentHint",children:"videoContentHint:"}),(0,n.jsx)(tJ.Z,{name:"videoContentHint",value:e,onChange:e=>{g(e.target.value,d.QO)&&t(ta(e.target.value))},children:d.QO.map(e=>(0,n.jsx)("option",{value:e,children:""===e?"":e},e))})]})},n1=()=>{let e=tu(e=>e.video),t=y(tu(e=>e.soraContents.connectionStatus)),a=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"video",children:(0,n.jsx)(a$,{kind:"video",checked:e,onChange:e=>{a(e7(e.target.checked))},disabled:t,children:"video"})})},n2=()=>{let e=tu(e=>e.enabledVideoH264Params),t=tu(e=>e.videoH264Params),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledVideoH264Params",children:(0,n.jsx)(a$,{kind:"videoH264Params",checked:e,onChange:e=>{i(eI(e.target.checked))},disabled:a,children:"videoH264Params"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"videoH264Params",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"videoH264Params",value:t,onChange:e=>{i(to(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},n5=()=>{let e=tu(e=>e.enabledVideoH265Params),t=tu(e=>e.videoH265Params),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledVideoH265Params",children:(0,n.jsx)(a$,{kind:"videoH265Params",checked:e,onChange:e=>{i(ew(e.target.checked))},disabled:a,children:"videoH265Params"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"videoH265Params",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"videoH265Params",value:t,onChange:e=>{i(tl(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},n6=()=>{let e=tu(e=>e.videoInput),t=tu(e=>e.videoInputDevices),a=td();return(0,n.jsxs)(tI.Z,{className:"form-inline",controlId:"videoInput",children:[(0,n.jsx)(ac,{kind:"videoInput",children:"videoInput:"}),(0,n.jsxs)(tJ.Z,{name:"videoInput",value:e,onChange:e=>{a(tn(e.target.value)),a(E())},disabled:0===t.length,children:[(0,n.jsx)("option",{value:"",children:""}),t.map(e=>(0,n.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId))]})]})},n4=()=>{let e=tu(e=>e.videoTrack),t=td();return(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"videoTrack",children:(0,n.jsx)(a$,{kind:"videoTrack",checked:e,onChange:e=>{t(ti(e.target.checked))},disabled:!1,children:"Enable video track"})})},n9=()=>{let e=tu(e=>e.enabledVideoVP9Params),t=tu(e=>e.videoVP9Params),a=y(tu(e=>e.soraContents.connectionStatus)),i=td();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"enabledVideoVP9Params",children:(0,n.jsx)(a$,{kind:"videoVP9Params",checked:e,onChange:e=>{i(eT(e.target.checked))},disabled:a,children:"videoVP9Params"})})})}),e?(0,n.jsx)(at.Z,{className:"form-row",children:(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(tI.Z,{className:"form-inline",controlId:"videoVP9Params",children:(0,n.jsx)(tR.Z,{className:"flex-fill",as:"textarea",placeholder:"videoVP9Params",value:t,onChange:e=>{i(ts(e.target.value))},rows:10,cols:100,disabled:a})})})}):null]})},n3=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",xs:"auto",children:(0,n.jsx)(aa.Z,{xs:"12",sm:"12",className:"form-channel-id",children:(0,n.jsx)(a8,{})})}),(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nH,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nR,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nE,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nJ,{})})]})]}),n8=()=>{let e=tu(e=>e.role),t=tu(e=>e.multistream),a=!("recvonly"===e&&("true"===t||""===t));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(aY,{})}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(aq,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(aK,{})})]})]}),(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(n1,{})}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nY,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(n$,{})})]})]})]})},n7=()=>"true"!==tu(e=>e.simulcast)?null:(0,n.jsx)(at.Z,{className:"form-row",xs:"auto",children:(0,n.jsx)(aa.Z,{children:(0,n.jsx)(n_,{})})}),ie=()=>"true"!==tu(e=>e.spotlight)?null:(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nz,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nL,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nG,{})})]}),it=()=>{let[e,t]=(0,i.useState)(!0),a=tu(e=>e.enabledBundleId),s=tu(e=>e.enabledClientId),o=tu(e=>e.enabledDataChannel),l=tu(e=>e.enabledDataChannels),r=tu(e=>e.enabledForwardingFilter),c=tu(e=>e.enabledMetadata),d=[a,s,o,l,r,c,tu(e=>e.enabledSignalingNotifyMetadata),tu(e=>e.enabledSignalingUrlCandidates),tu(e=>e.reconnect)].some(e=>e),u=["btn-collapse-options"];return e&&u.push("collapsed"),d&&u.push("fw-bold"),(0,n.jsxs)(at.Z,{className:"form-row",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)("a",{href:"#",className:u.join(" "),onClick:a=>{a.preventDefault(),t(!e)},children:"Signaling options"})}),(0,n.jsx)(th.Z,{in:!e,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(nM,{}),(0,n.jsx)(a7,{}),(0,n.jsx)(nI,{}),(0,n.jsx)(a9,{}),(0,n.jsx)(nU,{}),(0,n.jsx)(nB,{}),(0,n.jsx)(nj,{}),(0,n.jsx)(ni,{}),(0,n.jsx)(nn,{})]})})]})},ia=()=>{let[e,t]=(0,i.useState)(!0),a=tu(e=>e.enabledAudioStreamingLanguageCode),s=tu(e=>e.enabledVideoVP9Params),o=[a,s,tu(e=>e.enabledVideoH264Params),tu(e=>e.enabledVideoH265Params),tu(e=>e.enabledVideoAV1Params)].some(e=>e),l=["btn-collapse-options"];return e&&l.push("collapsed"),o&&l.push("fw-bold"),(0,n.jsxs)(at.Z,{className:"form-row",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)("a",{href:"#",className:l.join(" "),onClick:a=>{a.preventDefault(),t(!e)},children:"Advanced signaling options"})}),(0,n.jsx)(th.Z,{in:!e,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(a2,{}),(0,n.jsx)(n9,{}),(0,n.jsx)(nQ,{}),(0,n.jsx)(n2,{}),(0,n.jsx)(n5,{})]})})]})},ii=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{xs:"auto",className:"form-row",children:(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nT,{})})}),(0,n.jsx)(at.Z,{xs:"auto",className:"form-row",children:(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nx,{})})})]}),is=()=>{let[e,t]=(0,i.useState)(!0),a=tu(e=>e.audioContentHint),s=tu(e=>e.autoGainControl),o=tu(e=>e.noiseSuppression),l=tu(e=>e.echoCancellation),r=tu(e=>e.echoCancellationType),c=tu(e=>e.videoContentHint),d=tu(e=>e.resolution),u=tu(e=>e.frameRate),m=[""!==a,""!==s,""!==o,""!==l,""!==r,""!==c,""!==d,""!==u,""!==tu(e=>e.blurRadius),""!==tu(e=>e.lightAdjustment),tu(e=>e.mediaProcessorsNoiseSuppression)].some(e=>e),g=["btn-collapse-options"];return e&&g.push("collapsed"),m&&g.push("fw-bold"),(0,n.jsxs)(at.Z,{className:"form-row",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)("a",{href:"#",className:g.join(" "),onClick:a=>{a.preventDefault(),t(!e)},children:"Media options"})}),(0,n.jsx)(th.Z,{in:!e,children:(0,n.jsxs)("div",{children:[(0,n.jsxs)(at.Z,{className:"form-row",children:[(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(aQ,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(a6,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nZ,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nh,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(np,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(ny,{})})]}),(0,n.jsxs)(at.Z,{className:"form-row",children:[(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(n0,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nO,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nb,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(aW,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nD,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(a4,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nS,{})}),(0,n.jsx)(aa.Z,{className:"col-auto",children:(0,n.jsx)(nv,{})})]}),(0,n.jsx)(nq,{})]})})]})},io=()=>{let e=tu(e=>e.role),t=tu(e=>e.mediaType);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(at.Z,{className:"form-row",xs:"auto",children:"recvonly"!==e&&"getUserMedia"===t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(a0,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(n6,{})})]}):null}),(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:["sendonly"!==e?(0,n.jsx)(aa.Z,{children:(0,n.jsx)(a1,{})}):null,(0,n.jsx)(nP,{}),"recvonly"!==e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nV,{}),(0,n.jsx)(ng,{})]}):null]})]})},il=()=>{let e=tu(e=>e.role);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nm,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nN,{})})]}),"recvonly"!==e&&(0,n.jsxs)(at.Z,{className:"form-row",xs:"auto",children:[(0,n.jsx)(aa.Z,{children:(0,n.jsx)(nw,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(a3,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(a5,{})}),(0,n.jsx)(aa.Z,{children:(0,n.jsx)(n4,{})})]})]})},ir=()=>{let e=tu(e=>e.debug),t=tu(e=>e.role),a=tu(e=>e.multistream);return(0,n.jsxs)("div",{className:e?"col-devtools col-6":"col-devtools col-12",children:[(0,n.jsx)(ao,{}),(0,n.jsx)(n3,{}),(0,n.jsx)(n7,{}),(0,n.jsx)(ie,{}),(0,n.jsx)("hr",{className:"hr-form"}),(0,n.jsx)(n8,{}),(0,n.jsx)(it,{}),!("recvonly"===t&&("true"===a||""===a))&&(0,n.jsx)(ia,{}),(0,n.jsx)("hr",{className:"hr-form"}),"recvonly"!==t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ii,{}),(0,n.jsx)(is,{}),(0,n.jsx)("hr",{className:"hr-form"})]}):null,(0,n.jsx)(io,{}),(0,n.jsx)(il,{}),(0,n.jsx)("hr",{className:"hr-form"}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)(ne,{}),(0,n.jsx)(ns,{}),(0,n.jsx)(nW,{}),(0,n.jsx)(nK,{})]}),(0,n.jsx)("hr",{className:"hr-form"}),(0,n.jsx)(aD,{}),"recvonly"===t||"sendrecv"===t?(0,n.jsx)(aG,{}):null]})};var ic=a(6567),id=a(2838);let iu=()=>{let e=tu(e=>e.debug),t=td();return(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"button",className:e?"btn btn-footer-debug-mode active":"btn btn-footer-debug-mode",onClick:()=>{t(em(!e))},children:"debug"})})},im=()=>{let e=tu(e=>e.version);return(0,n.jsxs)("footer",{children:[(0,n.jsxs)(ic.Z,{variant:"dark",bg:"sora",expand:"md",fixed:"bottom",children:[(0,n.jsx)(id.Z,{className:"me-auto"}),(0,n.jsx)(id.Z,{children:(0,n.jsxs)(ic.Z.Collapse,{id:"navbar-collapse",children:[(0,n.jsxs)("a",{href:"https://github.com/shiguredo/sora-devtools",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-devtools: ",e]}),(0,n.jsxs)("a",{href:"https://github.com/shiguredo/sora-js-sdk",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-js-sdk: ",r.Z.version()]})]})})]}),(0,n.jsx)(iu,{})]})};var ig=a(7578),ih=a.n(ig);let ip=()=>(0,n.jsx)(ih(),{children:(0,n.jsx)("title",{children:"Sora DevTools"})});var iv=a(5018);let ix=()=>{let e=td();return(0,n.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"copyUrl",defaultValue:"copy URL",onClick:()=>{e(w())}})},ij=()=>{let e=tu(e=>e.debug),t=td(),a=["btn","btn-header-debug-mode","btn-sm","ms-1"];return e&&a.push("active"),(0,n.jsx)("input",{className:a.join(" "),type:"button",name:"debug",defaultValue:"debug",onClick:()=>{t(em(!e))}})};var iC=a(1913);let ib=()=>{let e=(0,i.useRef)(null);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"downloadReport",defaultValue:"Download report",onClick:()=>{let t=new Blob([JSON.stringify(function(){let e=iC.h.getState(),t={aspectRatio:e.aspectRatio,audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,audioContentHint:e.audioContentHint,audioInput:e.audioInput,audioInputDevices:e.audioInputDevices,audioOutput:e.audioOutput,audioOutputDevices:e.audioOutputDevices,audioStreamingLanguageCode:e.audioStreamingLanguageCode,audioTrack:e.audioTrack,autoGainControl:e.autoGainControl,bundleId:e.bundleId,cameraDevice:e.cameraDevice,channelId:e.channelId,clientId:e.clientId,dataChannelSignaling:e.dataChannelSignaling,dataChannels:e.dataChannels,debug:e.debug,displayResolution:e.displayResolution,echoCancellation:e.echoCancellation,echoCancellationType:e.echoCancellationType,enabledAudioStreamingLanguageCode:e.enabledAudioStreamingLanguageCode,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledDataChannels:e.enabledDataChannels,enabledForwardingFilter:e.enabledForwardingFilter,enabledMetadata:e.enabledMetadata,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,enabledSignalingUrlCandidates:e.enabledSignalingUrlCandidates,enabledVideoVP9Params:e.enabledVideoVP9Params,enabledVideoH264Params:e.enabledVideoH264Params,enabledVideoH265Params:e.enabledVideoH265Params,enabledVideoAV1Params:e.enabledVideoAV1Params,facingMode:e.facingMode,fakeVolume:e.fakeVolume,forwardingFilter:e.forwardingFilter,frameRate:e.frameRate,googCpuOveruseDetection:e.googCpuOveruseDetection,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,mediaType:e.mediaType,metadata:e.metadata,micDevice:e.micDevice,multistream:e.multistream,noiseSuppression:e.noiseSuppression,reconnect:e.reconnect,resizeMode:e.resizeMode,resolution:e.resolution,mediaStats:e.mediaStats,role:e.role,signalingNotifyMetadata:e.signalingNotifyMetadata,signalingUrlCandidates:e.signalingUrlCandidates,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType,videoContentHint:e.videoContentHint,videoInput:e.videoInput,videoInputDevices:e.videoInputDevices,videoTrack:e.videoTrack,videoVP9Params:e.videoVP9Params,videoH264Params:e.videoH264Params,videoH265Params:e.videoH265Params,videoAV1Params:e.videoAV1Params};return{userAgent:navigator.userAgent,"sora-devtools":e.version,"sora-js-sdk":r.Z.version(),parameters:t,timeline:e.timelineMessages.map(e=>({timestamp:e.timestamp,message:e})),notify:e.notifyMessages,stats:e.soraContents.statsReport}}())],{type:"text/plain"});if(window.URL=window.URL||window.webkitURL,e.current){let a=new Date().toISOString().replaceAll(":","_").replaceAll(".","_");e.current.download="sora-devtools-report-".concat(a,".json"),e.current.href=window.URL.createObjectURL(t),e.current.click()}}}),(0,n.jsx)("a",{ref:e,style:{display:"none"}})]})},iS=()=>{let e=tu(e=>e.soraContents.connectionStatus),t=tu(e=>e.soraContents.turnUrl),a=tu(e=>e.soraContents.sora);return(0,n.jsx)("header",{children:(0,n.jsx)(ic.Z,{variant:"dark",bg:"sora",expand:"lg",fixed:"top",children:(0,n.jsxs)(iv.Z,{children:[(0,n.jsx)(ic.Z.Brand,{href:"/",children:"Sora DevTools"}),(0,n.jsx)(ic.Z.Toggle,{"aria-controls":"navbar-collapse"}),(0,n.jsxs)(ic.Z.Collapse,{id:"navbar-collapse",children:[(0,n.jsx)(id.Z,{className:"me-auto"}),(0,n.jsxs)(id.Z,{children:[(0,n.jsx)(ic.Z.Text,{className:"py-0 my-1 mx-1",children:(0,n.jsx)("p",{className:"navbar-signaling-url border rounded",children:a&&"connected"===e?a.connectedSignalingUrl:"Signaling URL"})}),(0,n.jsx)(ic.Z.Text,{className:"py-0 my-1 mx-1",children:(0,n.jsx)("p",{className:"navbar-turn-url border rounded",children:a&&"connected"===e?null!==t?t:"":"TURN URL"})}),(0,n.jsx)(ic.Z.Text,{className:"py-0 my-1 mx-1",children:(0,n.jsx)(ij,{})}),(0,n.jsx)(ic.Z.Text,{className:"py-0 my-1 mx-1",children:(0,n.jsx)(ib,{})}),(0,n.jsx)(ic.Z.Text,{className:"py-0 my-1 ms-1",children:(0,n.jsx)(ix,{})})]})]})]})})})};var iy=a(4569),iN=a.n(iy);let ik=()=>{let e=tu(e=>e.mediaType),t={x:100,y:100},[a,s]=(0,i.useState)(t),[o,l]=(0,i.useState)(0);return((0,i.useEffect)(()=>{let e=()=>{if(void 0!==window){var e;l((e=window.innerWidth)<680?e-40:640)}};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),"mediacaptureRegion"!==e)?null:(0,n.jsx)(iN(),{position:a,onDrag:(e,t)=>{s({x:t.x,y:t.y})},defaultPosition:t,children:(0,n.jsx)("div",{id:"cropArea",className:"cropArea",style:{width:"".concat(o,"px"),height:"".concat(Math.floor(o/4*3),"px")}})})};var iT=()=>{let e=td();return(0,i.useEffect)(()=>(e(I()),e(B()),()=>{e(U())}),[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ik,{}),(0,n.jsx)(ip,{}),(0,n.jsx)(iS,{}),(0,n.jsx)("main",{children:(0,n.jsx)("div",{className:"container",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)(ir,{}),(0,n.jsx)(ae,{})]})})}),(0,n.jsx)(im,{})]})}}},function(e){e.O(0,[282,356,888,774,179],function(){return e(e.s=2124)}),_N_E=e.O()}]);